# å›¾ç‰‡åˆ†æAPIå‰ç«¯è°ƒç”¨ç¤ºä¾‹

## HTMLç¤ºä¾‹

### åŸºç¡€å›¾ç‰‡ä¸Šä¼ å’Œåˆ†æ

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›¾ç‰‡åˆ†æç¤ºä¾‹</title>
    <style>
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        .upload-area:hover {
            border-color: #007bff;
        }
        .upload-area.dragover {
            border-color: #007bff;
            background-color: #f8f9fa;
        }
        .preview {
            max-width: 300px;
            margin: 20px 0;
        }
        .preview img {
            max-width: 100%;
            border-radius: 8px;
        }
        .result {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            white-space: pre-wrap;
        }
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        .error {
            color: #dc3545;
            background-color: #f8d7da;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success {
            color: #155724;
            background-color: #d4edda;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .form-group textarea {
            height: 80px;
            resize: vertical;
        }
        .btn {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ–¼ï¸ å›¾ç‰‡åˆ†æå·¥å…·</h1>
        <p>åŸºäºé˜¿é‡Œäº‘é€šä¹‰åƒé—®å¤§æ¨¡å‹çš„æ™ºèƒ½å›¾ç‰‡ç†è§£</p>

        <!-- å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ -->
        <div class="upload-area" id="uploadArea">
            <div id="uploadText">
                <h3>ğŸ“ ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ å›¾ç‰‡</h3>
                <p>æ”¯æŒ JPGã€PNGã€GIFã€WebPã€BMP æ ¼å¼ï¼Œæœ€å¤§ 10MB</p>
                <input type="file" id="fileInput" accept="image/*" style="display: none;">
            </div>
            <div id="preview" class="preview" style="display: none;"></div>
        </div>

        <!-- åˆ†æå‚æ•° -->
        <div class="form-group">
            <label for="prompt">åˆ†ææç¤ºè¯ï¼š</label>
            <textarea id="prompt" placeholder="è¯·è¾“å…¥åˆ†ææç¤ºè¯ï¼Œä¾‹å¦‚ï¼šè¯·è¯¦ç»†æè¿°è¿™å¼ å›¾ç‰‡çš„å†…å®¹ï¼ŒåŒ…æ‹¬ä¸»è¦å…ƒç´ ã€é¢œè‰²ã€åœºæ™¯ç­‰">è¯·è¯¦ç»†æè¿°è¿™å¼ å›¾ç‰‡çš„å†…å®¹ï¼ŒåŒ…æ‹¬ä¸»è¦å…ƒç´ ã€é¢œè‰²ã€åœºæ™¯ç­‰</textarea>
        </div>

        <!-- æ“ä½œæŒ‰é’® -->
        <button class="btn" id="analyzeBtn" disabled>ğŸ” å¼€å§‹åˆ†æ</button>
        <button class="btn" id="urlAnalyzeBtn" style="margin-left: 10px;">ğŸŒ URLåˆ†æ</button>

        <!-- åŠ è½½çŠ¶æ€ -->
        <div class="loading" id="loading">
            <p>ğŸ”„ æ­£åœ¨åˆ†æå›¾ç‰‡ï¼Œè¯·ç¨å€™...</p>
        </div>

        <!-- ç»“æœæ˜¾ç¤º -->
        <div id="result" class="result" style="display: none;"></div>

        <!-- é”™è¯¯ä¿¡æ¯ -->
        <div id="error" class="error" style="display: none;"></div>

        <!-- æˆåŠŸä¿¡æ¯ -->
        <div id="success" class="success" style="display: none;"></div>
    </div>

    <script>
        // é…ç½®
        const API_BASE_URL = 'http://localhost:3000';
        const TOKEN = localStorage.getItem('authToken') || prompt('è¯·è¾“å…¥è®¤è¯Token:');

        // DOMå…ƒç´ 
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const preview = document.getElementById('preview');
        const uploadText = document.getElementById('uploadText');
        const promptInput = document.getElementById('prompt');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const urlAnalyzeBtn = document.getElementById('urlAnalyzeBtn');
        const loading = document.getElementById('loading');
        const result = document.getElementById('result');
        const error = document.getElementById('error');
        const success = document.getElementById('success');

        let selectedFile = null;

        // äº‹ä»¶ç›‘å¬
        uploadArea.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', handleFileSelect);
        uploadArea.addEventListener('dragover', handleDragOver);
        uploadArea.addEventListener('dragleave', handleDragLeave);
        uploadArea.addEventListener('drop', handleDrop);
        analyzeBtn.addEventListener('click', analyzeImage);
        urlAnalyzeBtn.addEventListener('click', showUrlAnalyzeDialog);

        // æ–‡ä»¶é€‰æ‹©å¤„ç†
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                processFile(file);
            }
        }

        // æ‹–æ‹½å¤„ç†
        function handleDragOver(event) {
            event.preventDefault();
            uploadArea.classList.add('dragover');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            uploadArea.classList.remove('dragover');
        }

        function handleDrop(event) {
            event.preventDefault();
            uploadArea.classList.remove('dragover');
            
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                processFile(files[0]);
            }
        }

        // å¤„ç†æ–‡ä»¶
        function processFile(file) {
            // éªŒè¯æ–‡ä»¶ç±»å‹
            if (!file.type.startsWith('image/')) {
                showError('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶');
                return;
            }

            // éªŒè¯æ–‡ä»¶å¤§å° (10MB)
            if (file.size > 10 * 1024 * 1024) {
                showError('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB');
                return;
            }

            selectedFile = file;
            
            // æ˜¾ç¤ºé¢„è§ˆ
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.innerHTML = `<img src="${e.target.result}" alt="é¢„è§ˆ">`;
                preview.style.display = 'block';
                uploadText.style.display = 'none';
                analyzeBtn.disabled = false;
            };
            reader.readAsDataURL(file);
        }

        // åˆ†æå›¾ç‰‡
        async function analyzeImage() {
            if (!selectedFile) {
                showError('è¯·å…ˆé€‰æ‹©å›¾ç‰‡æ–‡ä»¶');
                return;
            }

            const prompt = promptInput.value.trim();
            if (!prompt) {
                showError('è¯·è¾“å…¥åˆ†ææç¤ºè¯');
                return;
            }

            showLoading(true);
            hideMessages();

            try {
                const formData = new FormData();
                formData.append('image', selectedFile);
                formData.append('prompt', prompt);

                const response = await fetch(`${API_BASE_URL}/api/image-analysis/upload-analyze`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${TOKEN}`
                    },
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    showSuccess('å›¾ç‰‡åˆ†æå®Œæˆï¼');
                    showResult(data);
                } else {
                    showError(`åˆ†æå¤±è´¥: ${data.error} - ${data.detail || ''}`);
                }
            } catch (err) {
                showError(`è¯·æ±‚å¤±è´¥: ${err.message}`);
            } finally {
                showLoading(false);
            }
        }

        // URLåˆ†æå¯¹è¯æ¡†
        function showUrlAnalyzeDialog() {
            const imageUrl = prompt('è¯·è¾“å…¥å›¾ç‰‡URL:');
            if (!imageUrl) return;

            const prompt = promptInput.value.trim();
            if (!prompt) {
                showError('è¯·è¾“å…¥åˆ†ææç¤ºè¯');
                return;
            }

            analyzeImageByUrl(imageUrl, prompt);
        }

        // æ ¹æ®URLåˆ†æå›¾ç‰‡
        async function analyzeImageByUrl(imageUrl, prompt) {
            showLoading(true);
            hideMessages();

            try {
                const response = await fetch(`${API_BASE_URL}/api/image-analysis/analyze-url`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${TOKEN}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        imageUrl: imageUrl,
                        prompt: prompt
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    showSuccess('å›¾ç‰‡åˆ†æå®Œæˆï¼');
                    showResult(data);
                } else {
                    showError(`åˆ†æå¤±è´¥: ${data.error} - ${data.detail || ''}`);
                }
            } catch (err) {
                showError(`è¯·æ±‚å¤±è´¥: ${err.message}`);
            } finally {
                showLoading(false);
            }
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult(data) {
            const analysis = data.analysis;
            const usage = analysis.usage;
            
            let resultHtml = `
                <h3>ğŸ“Š åˆ†æç»“æœ</h3>
                <p><strong>å›¾ç‰‡URL:</strong> ${data.imageUrl}</p>
                <p><strong>åˆ†æå†…å®¹:</strong></p>
                <div style="background: white; padding: 15px; border-radius: 4px; margin: 10px 0;">
                    ${analysis.content}
                </div>
            `;

            if (usage) {
                resultHtml += `
                    <p><strong>Tokenä½¿ç”¨æƒ…å†µ:</strong></p>
                    <ul>
                        <li>è¾“å…¥Token: ${usage.input_tokens || usage.prompt_tokens || 0}</li>
                        <li>è¾“å‡ºToken: ${usage.output_tokens || usage.completion_tokens || 0}</li>
                        <li>æ€»Token: ${usage.total_tokens || 0}</li>
                    </ul>
                `;
            }

            result.innerHTML = resultHtml;
            result.style.display = 'block';
        }

        // å·¥å…·å‡½æ•°
        function showLoading(show) {
            loading.style.display = show ? 'block' : 'none';
            analyzeBtn.disabled = show;
        }

        function showError(message) {
            error.textContent = message;
            error.style.display = 'block';
        }

        function showSuccess(message) {
            success.textContent = message;
            success.style.display = 'block';
        }

        function hideMessages() {
            error.style.display = 'none';
            success.style.display = 'none';
            result.style.display = 'none';
        }

        // ä¿å­˜Tokenåˆ°æœ¬åœ°å­˜å‚¨
        if (TOKEN) {
            localStorage.setItem('authToken', TOKEN);
        }
    </script>
</body>
</html>
```

## Reactç»„ä»¶ç¤ºä¾‹

### ImageAnalysisComponent.jsx

```jsx
import React, { useState, useRef } from 'react';
import axios from 'axios';

const ImageAnalysisComponent = () => {
  const [selectedFile, setSelectedFile] = useState(null);
  const [preview, setPreview] = useState(null);
  const [prompt, setPrompt] = useState('è¯·è¯¦ç»†æè¿°è¿™å¼ å›¾ç‰‡çš„å†…å®¹ï¼ŒåŒ…æ‹¬ä¸»è¦å…ƒç´ ã€é¢œè‰²ã€åœºæ™¯ç­‰');
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState(null);
  const [error, setError] = useState(null);
  const fileInputRef = useRef();

  const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:3000';
  const TOKEN = localStorage.getItem('authToken');

  const handleFileSelect = (event) => {
    const file = event.target.files[0];
    if (file) {
      processFile(file);
    }
  };

  const handleDrop = (event) => {
    event.preventDefault();
    const files = event.dataTransfer.files;
    if (files.length > 0) {
      processFile(files[0]);
    }
  };

  const processFile = (file) => {
    if (!file.type.startsWith('image/')) {
      setError('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶');
      return;
    }

    if (file.size > 10 * 1024 * 1024) {
      setError('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB');
      return;
    }

    setSelectedFile(file);
    setError(null);

    const reader = new FileReader();
    reader.onload = (e) => setPreview(e.target.result);
    reader.readAsDataURL(file);
  };

  const analyzeImage = async () => {
    if (!selectedFile || !TOKEN) {
      setError('è¯·å…ˆé€‰æ‹©å›¾ç‰‡æ–‡ä»¶å¹¶ç¡®ä¿å·²ç™»å½•');
      return;
    }

    setLoading(true);
    setError(null);
    setResult(null);

    try {
      const formData = new FormData();
      formData.append('image', selectedFile);
      formData.append('prompt', prompt);

      const response = await axios.post(
        `${API_BASE_URL}/api/image-analysis/upload-analyze`,
        formData,
        {
          headers: {
            'Authorization': `Bearer ${TOKEN}`,
            'Content-Type': 'multipart/form-data',
          },
        }
      );

      setResult(response.data);
    } catch (err) {
      setError(err.response?.data?.error || err.message || 'åˆ†æå¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  const analyzeImageByUrl = async (imageUrl) => {
    if (!imageUrl || !TOKEN) {
      setError('è¯·è¾“å…¥å›¾ç‰‡URLå¹¶ç¡®ä¿å·²ç™»å½•');
      return;
    }

    setLoading(true);
    setError(null);
    setResult(null);

    try {
      const response = await axios.post(
        `${API_BASE_URL}/api/image-analysis/analyze-url`,
        {
          imageUrl,
          prompt,
        },
        {
          headers: {
            'Authorization': `Bearer ${TOKEN}`,
            'Content-Type': 'application/json',
          },
        }
      );

      setResult(response.data);
    } catch (err) {
      setError(err.response?.data?.error || err.message || 'åˆ†æå¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="image-analysis">
      <h2>ğŸ–¼ï¸ å›¾ç‰‡åˆ†æå·¥å…·</h2>
      
      {/* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */}
      <div
        className="upload-area"
        onDrop={handleDrop}
        onDragOver={(e) => e.preventDefault()}
        onClick={() => fileInputRef.current?.click()}
      >
        {preview ? (
          <img src={preview} alt="é¢„è§ˆ" className="preview-image" />
        ) : (
          <div className="upload-text">
            <h3>ğŸ“ ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ å›¾ç‰‡</h3>
            <p>æ”¯æŒ JPGã€PNGã€GIFã€WebPã€BMP æ ¼å¼ï¼Œæœ€å¤§ 10MB</p>
          </div>
        )}
        <input
          ref={fileInputRef}
          type="file"
          accept="image/*"
          onChange={handleFileSelect}
          style={{ display: 'none' }}
        />
      </div>

      {/* åˆ†æå‚æ•° */}
      <div className="form-group">
        <label>åˆ†ææç¤ºè¯ï¼š</label>
        <textarea
          value={prompt}
          onChange={(e) => setPrompt(e.target.value)}
          placeholder="è¯·è¾“å…¥åˆ†ææç¤ºè¯"
          rows={3}
        />
      </div>

      {/* æ“ä½œæŒ‰é’® */}
      <div className="button-group">
        <button
          onClick={analyzeImage}
          disabled={!selectedFile || loading}
          className="btn btn-primary"
        >
          {loading ? 'ğŸ”„ åˆ†æä¸­...' : 'ğŸ” å¼€å§‹åˆ†æ'}
        </button>
        
        <button
          onClick={() => {
            const url = prompt('è¯·è¾“å…¥å›¾ç‰‡URL:');
            if (url) analyzeImageByUrl(url);
          }}
          disabled={loading}
          className="btn btn-secondary"
        >
          ğŸŒ URLåˆ†æ
        </button>
      </div>

      {/* é”™è¯¯ä¿¡æ¯ */}
      {error && (
        <div className="error-message">
          âŒ {error}
        </div>
      )}

      {/* åˆ†æç»“æœ */}
      {result && (
        <div className="result-container">
          <h3>ğŸ“Š åˆ†æç»“æœ</h3>
          <p><strong>å›¾ç‰‡URL:</strong> {result.imageUrl}</p>
          <div className="analysis-content">
            {result.analysis.content}
          </div>
          {result.analysis.usage && (
            <div className="usage-info">
              <h4>Tokenä½¿ç”¨æƒ…å†µ:</h4>
              <ul>
                <li>è¾“å…¥Token: {result.analysis.usage.input_tokens || result.analysis.usage.prompt_tokens || 0}</li>
                <li>è¾“å‡ºToken: {result.analysis.usage.output_tokens || result.analysis.usage.completion_tokens || 0}</li>
                <li>æ€»Token: {result.analysis.usage.total_tokens || 0}</li>
              </ul>
            </div>
          )}
        </div>
      )}
    </div>
  );
};

export default ImageAnalysisComponent;
```

## Vueç»„ä»¶ç¤ºä¾‹

### ImageAnalysis.vue

```vue
<template>
  <div class="image-analysis">
    <h2>ğŸ–¼ï¸ å›¾ç‰‡åˆ†æå·¥å…·</h2>
    
    <!-- æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ -->
    <div
      class="upload-area"
      @drop="handleDrop"
      @dragover.prevent
      @click="triggerFileInput"
    >
      <img v-if="preview" :src="preview" alt="é¢„è§ˆ" class="preview-image" />
      <div v-else class="upload-text">
        <h3>ğŸ“ ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ å›¾ç‰‡</h3>
        <p>æ”¯æŒ JPGã€PNGã€GIFã€WebPã€BMP æ ¼å¼ï¼Œæœ€å¤§ 10MB</p>
      </div>
      <input
        ref="fileInput"
        type="file"
        accept="image/*"
        @change="handleFileSelect"
        style="display: none"
      />
    </div>

    <!-- åˆ†æå‚æ•° -->
    <div class="form-group">
      <label>åˆ†ææç¤ºè¯ï¼š</label>
      <textarea
        v-model="prompt"
        placeholder="è¯·è¾“å…¥åˆ†ææç¤ºè¯"
        rows="3"
      />
    </div>

    <!-- æ“ä½œæŒ‰é’® -->
    <div class="button-group">
      <button
        @click="analyzeImage"
        :disabled="!selectedFile || loading"
        class="btn btn-primary"
      >
        {{ loading ? 'ğŸ”„ åˆ†æä¸­...' : 'ğŸ” å¼€å§‹åˆ†æ' }}
      </button>
      
      <button
        @click="showUrlDialog"
        :disabled="loading"
        class="btn btn-secondary"
      >
        ğŸŒ URLåˆ†æ
      </button>
    </div>

    <!-- é”™è¯¯ä¿¡æ¯ -->
    <div v-if="error" class="error-message">
      âŒ {{ error }}
    </div>

    <!-- åˆ†æç»“æœ -->
    <div v-if="result" class="result-container">
      <h3>ğŸ“Š åˆ†æç»“æœ</h3>
      <p><strong>å›¾ç‰‡URL:</strong> {{ result.imageUrl }}</p>
      <div class="analysis-content">
        {{ result.analysis.content }}
      </div>
      <div v-if="result.analysis.usage" class="usage-info">
        <h4>Tokenä½¿ç”¨æƒ…å†µ:</h4>
        <ul>
          <li>è¾“å…¥Token: {{ result.analysis.usage.input_tokens || result.analysis.usage.prompt_tokens || 0 }}</li>
          <li>è¾“å‡ºToken: {{ result.analysis.usage.output_tokens || result.analysis.usage.completion_tokens || 0 }}</li>
          <li>æ€»Token: {{ result.analysis.usage.total_tokens || 0 }}</li>
        </ul>
      </div>
    </div>
  </div>
</template>

<script>
import axios from 'axios';

export default {
  name: 'ImageAnalysis',
  data() {
    return {
      selectedFile: null,
      preview: null,
      prompt: 'è¯·è¯¦ç»†æè¿°è¿™å¼ å›¾ç‰‡çš„å†…å®¹ï¼ŒåŒ…æ‹¬ä¸»è¦å…ƒç´ ã€é¢œè‰²ã€åœºæ™¯ç­‰',
      loading: false,
      result: null,
      error: null,
      API_BASE_URL: process.env.VUE_APP_API_URL || 'http://localhost:3000',
      TOKEN: localStorage.getItem('authToken')
    };
  },
  methods: {
    triggerFileInput() {
      this.$refs.fileInput.click();
    },

    handleFileSelect(event) {
      const file = event.target.files[0];
      if (file) {
        this.processFile(file);
      }
    },

    handleDrop(event) {
      const files = event.dataTransfer.files;
      if (files.length > 0) {
        this.processFile(files[0]);
      }
    },

    processFile(file) {
      if (!file.type.startsWith('image/')) {
        this.error = 'è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶';
        return;
      }

      if (file.size > 10 * 1024 * 1024) {
        this.error = 'æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB';
        return;
      }

      this.selectedFile = file;
      this.error = null;

      const reader = new FileReader();
      reader.onload = (e) => this.preview = e.target.result;
      reader.readAsDataURL(file);
    },

    async analyzeImage() {
      if (!this.selectedFile || !this.TOKEN) {
        this.error = 'è¯·å…ˆé€‰æ‹©å›¾ç‰‡æ–‡ä»¶å¹¶ç¡®ä¿å·²ç™»å½•';
        return;
      }

      this.loading = true;
      this.error = null;
      this.result = null;

      try {
        const formData = new FormData();
        formData.append('image', this.selectedFile);
        formData.append('prompt', this.prompt);

        const response = await axios.post(
          `${this.API_BASE_URL}/api/image-analysis/upload-analyze`,
          formData,
          {
            headers: {
              'Authorization': `Bearer ${this.TOKEN}`,
              'Content-Type': 'multipart/form-data',
            },
          }
        );

        this.result = response.data;
      } catch (err) {
        this.error = err.response?.data?.error || err.message || 'åˆ†æå¤±è´¥';
      } finally {
        this.loading = false;
      }
    },

    showUrlDialog() {
      const url = prompt('è¯·è¾“å…¥å›¾ç‰‡URL:');
      if (url) {
        this.analyzeImageByUrl(url);
      }
    },

    async analyzeImageByUrl(imageUrl) {
      if (!imageUrl || !this.TOKEN) {
        this.error = 'è¯·è¾“å…¥å›¾ç‰‡URLå¹¶ç¡®ä¿å·²ç™»å½•';
        return;
      }

      this.loading = true;
      this.error = null;
      this.result = null;

      try {
        const response = await axios.post(
          `${this.API_BASE_URL}/api/image-analysis/analyze-url`,
          {
            imageUrl,
            prompt: this.prompt,
          },
          {
            headers: {
              'Authorization': `Bearer ${this.TOKEN}`,
              'Content-Type': 'application/json',
            },
          }
        );

        this.result = response.data;
      } catch (err) {
        this.error = err.response?.data?.error || err.message || 'åˆ†æå¤±è´¥';
      } finally {
        this.loading = false;
      }
    }
  }
};
</script>

<style scoped>
.image-analysis {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
}

.upload-area {
  border: 2px dashed #ccc;
  border-radius: 8px;
  padding: 40px;
  text-align: center;
  margin-bottom: 20px;
  cursor: pointer;
  transition: border-color 0.3s;
}

.upload-area:hover {
  border-color: #007bff;
}

.preview-image {
  max-width: 300px;
  border-radius: 8px;
}

.form-group {
  margin-bottom: 15px;
}

.form-group label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
}

.form-group textarea {
  width: 100%;
  padding: 8px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  resize: vertical;
}

.button-group {
  margin-bottom: 20px;
}

.btn {
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  margin-right: 10px;
}

.btn-primary {
  background-color: #007bff;
  color: white;
}

.btn-primary:hover:not(:disabled) {
  background-color: #0056b3;
}

.btn-secondary {
  background-color: #6c757d;
  color: white;
}

.btn-secondary:hover:not(:disabled) {
  background-color: #545b62;
}

.btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.error-message {
  color: #dc3545;
  background-color: #f8d7da;
  padding: 10px;
  border-radius: 4px;
  margin: 10px 0;
}

.result-container {
  background-color: #f8f9fa;
  padding: 20px;
  border-radius: 8px;
  margin-top: 20px;
}

.analysis-content {
  background: white;
  padding: 15px;
  border-radius: 4px;
  margin: 10px 0;
  white-space: pre-wrap;
}

.usage-info ul {
  list-style: none;
  padding: 0;
}

.usage-info li {
  margin: 5px 0;
}
</style>
```

## ä½¿ç”¨è¯´æ˜

1. **é…ç½®ç¯å¢ƒå˜é‡**: ç¡®ä¿è®¾ç½®äº†æ­£ç¡®çš„APIåœ°å€å’Œè®¤è¯Token
2. **æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒç‚¹å‡»ä¸Šä¼ å’Œæ‹–æ‹½ä¸Šä¼ ä¸¤ç§æ–¹å¼
3. **è‡ªå®šä¹‰æç¤ºè¯**: å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´åˆ†ææç¤ºè¯
4. **é”™è¯¯å¤„ç†**: åŒ…å«å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º
5. **å“åº”å¼è®¾è®¡**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸
6. **Tokenç®¡ç†**: è‡ªåŠ¨ä¿å­˜å’Œè¯»å–è®¤è¯Token

è¿™äº›ç¤ºä¾‹ä»£ç æä¾›äº†å®Œæ•´çš„å‰ç«¯å®ç°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨æˆ–æ ¹æ®é¡¹ç›®éœ€æ±‚è¿›è¡Œè°ƒæ•´ã€‚
