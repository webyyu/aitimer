# 🎤 语音识别功能说明

## 📋 功能概述

AI助手现已支持语音识别功能，用户可以通过上传音频文件或录音来输入语音，系统会自动将语音转换为文字，并填充到输入框中。

## 🚀 使用方法

### 1. 语音输入按钮

在AI助手页面的底部输入区域，有一个**话筒按钮**：

- **默认状态**：显示话筒图标，点击开始语音输入
- **录音状态**：显示停止录音图标，点击停止录音
- **处理状态**：显示旋转图标，表示正在识别中

### 2. 语音输入流程

1. **点击话筒按钮**：触发文件选择对话框
2. **选择音频文件**：支持 MP3, WAV, M4A, AAC, FLAC, OGG 格式
3. **自动识别**：系统自动上传并识别音频文件
4. **查看结果**：识别完成后显示结果预览
5. **编辑或发送**：可以编辑识别结果或直接发送

### 3. 支持的文件格式

| 格式 | 扩展名 | 说明 |
|------|--------|------|
| MP3 | .mp3 | 最常用的音频格式 |
| WAV | .wav | 无损音频格式 |
| M4A | .m4a | Apple设备常用格式 |
| AAC | .aac | 高质量压缩格式 |
| FLAC | .flac | 无损压缩格式 |
| OGG | .ogg | 开源音频格式 |

### 4. 文件大小限制

- **最大文件大小**：10MB
- **推荐时长**：1-3分钟
- **最佳质量**：16kHz以上采样率

## 🎯 功能特性

### 实时状态显示

- **上传中**：显示"正在上传音频文件..."
- **识别中**：显示"正在识别中，请稍候..."
- **完成**：显示识别结果预览
- **失败**：显示错误信息和重试选项

### 智能结果处理

- **自动填充**：识别结果自动填充到输入框
- **结果预览**：显示识别文本的预览卡片
- **编辑功能**：可以编辑识别结果
- **快速发送**：一键发送识别结果

### 错误处理

- **格式验证**：自动检查文件格式和大小
- **网络重试**：网络错误时自动重试
- **用户提示**：清晰的错误信息提示
- **降级处理**：识别失败时不影响其他功能

## 🔧 技术实现

### 前端组件

- **MessageInput.vue**：集成了语音识别功能的输入组件
- **VoiceRecognitionStatus.vue**：语音识别状态显示组件
- **speechRecognitionService.js**：语音识别服务

### 后端接口

- **上传识别**：`POST /api/speech-recognition/recognize`
- **仅上传**：`POST /api/speech-recognition/upload`
- **URL识别**：`POST /api/speech-recognition/recognize-url`

### 认证机制

- 使用JWT Token进行用户认证
- 自动从localStorage获取认证信息
- 支持多种Token存储方式

## 📱 移动端适配

### 响应式设计

- 自适应不同屏幕尺寸
- 触摸友好的按钮设计
- 移动端优化的状态显示

### 性能优化

- 文件大小自动检查
- 进度条显示处理状态
- 内存使用优化

## 🎨 用户界面

### 视觉反馈

- **状态颜色**：不同状态使用不同颜色
- **动画效果**：平滑的过渡动画
- **图标变化**：根据状态动态变化图标

### 交互设计

- **悬停效果**：按钮悬停时的视觉反馈
- **点击反馈**：点击时的状态变化
- **键盘支持**：支持键盘快捷键

## 🚨 注意事项

### 使用限制

1. **文件格式**：仅支持音频文件，不支持视频文件
2. **文件大小**：单个文件不能超过10MB
3. **网络要求**：需要稳定的网络连接
4. **浏览器支持**：需要现代浏览器支持

### 隐私安全

1. **数据加密**：音频文件传输使用HTTPS加密
2. **临时存储**：识别完成后音频文件会被删除
3. **用户授权**：需要用户主动选择音频文件

## 🔍 故障排除

### 常见问题

**Q: 为什么无法选择音频文件？**
A: 请检查浏览器是否支持文件选择，确保点击了话筒按钮。

**Q: 识别失败怎么办？**
A: 请检查文件格式是否正确，文件大小是否在限制范围内，网络连接是否正常。

**Q: 识别结果不准确？**
A: 语音识别准确率受音频质量影响，建议使用清晰的录音，避免背景噪音。

**Q: 上传速度很慢？**
A: 请检查网络连接，大文件上传需要更多时间。

### 技术支持

如果遇到技术问题，请：

1. 检查浏览器控制台的错误信息
2. 确认网络连接正常
3. 尝试使用不同的音频文件
4. 联系技术支持团队

## 📈 未来计划

### 功能增强

- [ ] 实时语音识别
- [ ] 多语言支持
- [ ] 语音命令识别
- [ ] 智能语音助手

### 性能优化

- [ ] 离线识别支持
- [ ] 批量文件处理
- [ ] 智能压缩算法
- [ ] 缓存机制优化

## 📚 相关文档

- [前端调用指南](./前端调用指南.md)
- [AI助手API文档](./AI助手API速查表.md)
- [项目架构说明](./重构总结.md)

---

*最后更新：2024年12月*
*版本：v1.0.0*
