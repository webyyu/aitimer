{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport AIHeader from '../components/AIsecretary/Header.vue';\nimport MessageCard from '../components/AIsecretary/MessageCard.vue';\nimport MessageInput from '../components/AIsecretary/MessageInput.vue';\nimport AssistantSettingsModal from '../components/AIsecretary/AssistantSettingsModal.vue';\nimport VoiceRecognitionStatus from '../components/AIsecretary/VoiceRecognitionStatus.vue';\n\n// ÂØºÂÖ•AIÊúçÂä°\nimport messageService from '../AIsiri/services/messageService.js';\nimport aisiriService from '../AIsiri/services/aiApi.js';\nimport aiAssistantService from '../AIsiri/services/aiAssistantService.js';\nimport speechRecognitionService from '../AIsiri/services/speechRecognitionService.js';\nimport { QUICK_ACTIONS } from '../AIsiri/types/index.js';\nimport { log } from '../AIsiri/utils/logger.js';\nexport default {\n  name: 'AiSecretary',\n  components: {\n    AIHeader,\n    MessageCard,\n    MessageInput,\n    AssistantSettingsModal,\n    VoiceRecognitionStatus\n  },\n  data() {\n    return {\n      isTyping: false,\n      messages: [],\n      quickActions: QUICK_ACTIONS,\n      messageService: messageService,\n      // Ê∑ªÂä†ËøûÊé•Áä∂ÊÄÅ\n      connectionStatus: 'connecting',\n      // connecting, connected, error\n      // Ê∑ªÂä†ÈîôËØØ‰ø°ÊÅØ\n      errorMessage: null,\n      // AIÂä©ÊâãÁõ∏ÂÖ≥\n      assistant: null,\n      showSettingsModal: false,\n      // ËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅ\n      showVoiceStatus: false,\n      voiceStatusType: 'processing',\n      voiceStatusTitle: '',\n      voiceStatusMessage: '',\n      voiceStatusProgress: 0,\n      voiceStatusAutoClose: 3000\n    };\n  },\n  methods: {\n    /**\n     * ÂèëÈÄÅÊ∂àÊÅØ\n     */\n    async sendMessage(message) {\n      // Ê£ÄÊü•Ê∂àÊÅØÁ±ªÂûã\n      if (typeof message === 'string') {\n        // ÊñáÊú¨Ê∂àÊÅØ\n        if (!message || !message.trim()) {\n          log.warn('ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•ÔºöÊ∂àÊÅØÂÜÖÂÆπ‰∏∫Á©∫');\n          return;\n        }\n        try {\n          log.user('ÂèëÈÄÅÊñáÊú¨Ê∂àÊÅØ', {\n            message: message\n          });\n\n          // ÊòæÁ§∫ÊâìÂ≠óÁä∂ÊÄÅ\n          this.isTyping = true;\n\n          // Â§ÑÁêÜÁî®Êà∑ËæìÂÖ• - ‰ΩøÁî®Êô∫ËÉΩË∞ÉÂ∫¶Á≥ªÁªü\n          await this.messageService.processUserInput(message.trim());\n\n          // Êõ¥Êñ∞Ê∂àÊÅØÂàóË°®\n          this.updateMessages();\n\n          // Â¢ûÂä†ÂøÉÂä®ÂÄº\n          await this.increaseHeartValue();\n        } catch (error) {\n          log.error('ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•', error);\n          this.handleError('ÂèëÈÄÅÊ∂àÊÅØÊó∂Âá∫Áé∞ÈîôËØØÔºåËØ∑Á®çÂêéÈáçËØï');\n        } finally {\n          this.isTyping = false;\n          this.$nextTick(() => {\n            this.scrollToBottom();\n          });\n        }\n      } else if (message && message.type === 'image') {\n        // ÂõæÁâáÊ∂àÊÅØ\n        try {\n          log.user('ÂèëÈÄÅÂõæÁâáÊ∂àÊÅØ', {\n            fileName: message.fileName,\n            fileSize: message.fileSize,\n            imageUrl: message.imageUrl\n          });\n\n          // Áõ¥Êé•Ê∑ªÂä†Áî®Êà∑ÂõæÁâáÊ∂àÊÅØÂà∞Ê∂àÊÅØÂàóË°®Ôºå‰∏çËß¶ÂèëÊô∫ËÉΩË∞ÉÂ∫¶\n          await this.messageService.addUserMessage(`üñºÔ∏è ÂõæÁâáÔºö${message.fileName} (${this.formatFileSize(message.fileSize)})`, 'IMAGE', {\n            imageUrl: message.imageUrl\n          });\n\n          // Êõ¥Êñ∞Ê∂àÊÅØÂàóË°®\n          this.updateMessages();\n\n          // ÊªöÂä®Âà∞Â∫ïÈÉ®\n          this.$nextTick(() => {\n            this.scrollToBottom();\n          });\n        } catch (error) {\n          log.error('ÂèëÈÄÅÂõæÁâáÊ∂àÊÅØÂ§±Ë¥•', error);\n          this.handleError('ÂèëÈÄÅÂõæÁâáÊ∂àÊÅØÊó∂Âá∫Áé∞ÈîôËØØÔºåËØ∑Á®çÂêéÈáçËØï');\n        }\n      } else {\n        log.warn('ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•ÔºöÊó†ÊïàÁöÑÊ∂àÊÅØÊ†ºÂºè');\n        return;\n      }\n    },\n    /**\n     * Ê†ºÂºèÂåñÊñá‰ª∂Â§ßÂ∞è\n     */\n    formatFileSize(bytes) {\n      if (bytes === 0) return '0 Bytes';\n      const k = 1024;\n      const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n      const i = Math.floor(Math.log(bytes) / Math.log(k));\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n    },\n    /**\n     * ÂèëÈÄÅËØ≠Èü≥Ê∂àÊÅØ\n     */\n    async sendVoiceMessage(voiceData) {\n      try {\n        log.user('ÂèëÈÄÅËØ≠Èü≥Ê∂àÊÅØ', {\n          duration: voiceData.duration,\n          transcription: voiceData.transcription\n        });\n\n        // Â¶ÇÊûúÊúâËØÜÂà´ÊñáÊú¨ÔºåÂèëÈÄÅÂà∞AIÂä©Êâã\n        if (voiceData.transcription) {\n          // ÊòæÁ§∫Â§ÑÁêÜÁä∂ÊÄÅ\n          this.isTyping = true;\n\n          // ‰ΩøÁî®Ê∂àÊÅØÊúçÂä°ÁöÑËØ≠Èü≥Â§ÑÁêÜÊñπÊ≥ïÔºà‰ºöËá™Âä®Ê∑ªÂä†Áî®Êà∑ËØ≠Èü≥Ê∂àÊÅØÔºâ\n          await this.messageService.processVoiceInput(voiceData);\n\n          // Êõ¥Êñ∞Ê∂àÊÅØÂàóË°®\n          this.updateMessages();\n\n          // Â¢ûÂä†ÂøÉÂä®ÂÄº\n          await this.increaseHeartValue();\n        }\n      } catch (error) {\n        log.error('ÂèëÈÄÅËØ≠Èü≥Ê∂àÊÅØÂ§±Ë¥•', error);\n        this.handleError('ÂèëÈÄÅËØ≠Èü≥Ê∂àÊÅØÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');\n      } finally {\n        this.isTyping = false;\n        this.$nextTick(() => {\n          this.scrollToBottom();\n        });\n      }\n    },\n    /**\n     * ÂèëÈÄÅÂø´ÈÄüÊ∂àÊÅØ\n     */\n    async sendQuickMessage(text) {\n      log.user('‰ΩøÁî®Âø´ÈÄüÊìç‰Ωú', {\n        message: text\n      });\n      await this.sendMessage(text);\n    },\n    /**\n     * Êõ¥Êñ∞Ê∂àÊÅØÂàóË°®\n     */\n    updateMessages() {\n      this.messages = this.messageService.getMessages();\n      log.debug('Ê∂àÊÅØÂàóË°®Â∑≤Êõ¥Êñ∞', {\n        messageCount: this.messages.length\n      });\n    },\n    /**\n     * Â§ÑÁêÜÈîôËØØ\n     */\n    handleError(message) {\n      this.errorMessage = message;\n      this.connectionStatus = 'error';\n\n      // 3ÁßíÂêéËá™Âä®Ê∏ÖÈô§ÈîôËØØ‰ø°ÊÅØ\n      setTimeout(() => {\n        this.errorMessage = null;\n        this.connectionStatus = 'connected';\n      }, 3000);\n    },\n    /**\n     * Ê£ÄÊü•ËøûÊé•Áä∂ÊÄÅ\n     */\n    async checkConnection() {\n      try {\n        log.api('Ê£ÄÊü•AIsiriÊô∫ËÉΩË∞ÉÂ∫¶ÊúçÂä°ËøûÊé•Áä∂ÊÄÅ');\n        this.connectionStatus = 'connecting';\n        const response = await aisiriService.healthCheck();\n        if (response.success) {\n          this.connectionStatus = 'connected';\n          log.success('AIsiriÊô∫ËÉΩË∞ÉÂ∫¶ÊúçÂä°ËøûÊé•Ê≠£Â∏∏');\n        } else {\n          throw new Error('ÂÅ•Â∫∑Ê£ÄÊü•Â§±Ë¥•');\n        }\n      } catch (error) {\n        log.error('ËøûÊé•Ê£ÄÊü•Â§±Ë¥•', error);\n        this.connectionStatus = 'error';\n        this.errorMessage = 'Êó†Ê≥ïËøûÊé•Âà∞AIsiriÊô∫ËÉΩË∞ÉÂ∫¶ÊúçÂä°ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•';\n      }\n    },\n    /**\n     * ÈáçÊñ∞ËøûÊé•\n     */\n    async reconnect() {\n      log.info('Â∞ùËØïÈáçÊñ∞ËøûÊé•AIsiriÊô∫ËÉΩË∞ÉÂ∫¶ÊúçÂä°');\n      await this.checkConnection();\n    },\n    /**\n     * Ê∏ÖÈô§ÊâÄÊúâÊ∂àÊÅØ\n     */\n    clearMessages() {\n      log.user('Ê∏ÖÈô§Ê∂àÊÅØÂéÜÂè≤');\n      this.messageService.clearMessages();\n      this.updateMessages();\n    },\n    /**\n     * ÊªöÂä®Âà∞Â∫ïÈÉ®\n     */\n    scrollToBottom() {\n      this.$nextTick(() => {\n        const chatContainer = document.querySelector('.chat-container');\n        if (chatContainer) {\n          chatContainer.scrollTop = chatContainer.scrollHeight;\n        }\n      });\n    },\n    /**\n     * ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩïÔºàË∞ÉËØïÁî®Ôºâ\n     */\n    exportChatHistory() {\n      const history = this.messageService.exportMessages();\n      log.table(history, 'ËÅäÂ§©ËÆ∞ÂΩïÂØºÂá∫');\n\n      // ‰∏ãËΩΩ‰∏∫JSONÊñá‰ª∂\n      const blob = new Blob([JSON.stringify(history, null, 2)], {\n        type: 'application/json'\n      });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `aisiri_chat_history_${new Date().toISOString().slice(0, 10)}.json`;\n      a.click();\n      URL.revokeObjectURL(url);\n    },\n    /**\n     * Â¢ûÂä†ÂøÉÂä®ÂÄº\n     */\n    async increaseHeartValue() {\n      try {\n        await aiAssistantService.increaseHeartValue();\n        log.info('ÂøÉÂä®ÂÄºÂ¢ûÂä†ÊàêÂäü');\n      } catch (error) {\n        log.error('Â¢ûÂä†ÂøÉÂä®ÂÄºÂ§±Ë¥•:', error);\n        // ‰∏çÂΩ±Âìç‰∏ªË¶ÅÂäüËÉΩÔºåÂè™ËÆ∞ÂΩïÈîôËØØ\n      }\n    },\n    /**\n     * ÊâìÂºÄËÆæÁΩÆÊ®°ÊÄÅÊ°Ü\n     */\n    openSettingsModal() {\n      this.showSettingsModal = true;\n    },\n    /**\n     * ÂÖ≥Èó≠ËÆæÁΩÆÊ®°ÊÄÅÊ°Ü\n     */\n    closeSettingsModal() {\n      this.showSettingsModal = false;\n    },\n    /**\n     * ‰øùÂ≠òAIÂä©ÊâãËÆæÁΩÆ\n     */\n    async saveAssistantSettings(newName) {\n      try {\n        await aiAssistantService.updateAssistantName(newName);\n        log.success('AIÂä©ÊâãÂêçÁß∞Êõ¥Êñ∞ÊàêÂäü:', newName);\n        // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫\n        this.$toast?.success?.(`AIÂä©ÊâãÂêçÁß∞Â∑≤Êõ¥Êñ∞‰∏∫\"${newName}\"`) || console.log(`AIÂä©ÊâãÂêçÁß∞Â∑≤Êõ¥Êñ∞‰∏∫\"${newName}\"`);\n      } catch (error) {\n        log.error('Êõ¥Êñ∞AIÂä©ÊâãÂêçÁß∞Â§±Ë¥•:', error);\n        // ÊòæÁ§∫ÈîôËØØÊèêÁ§∫\n        this.$toast?.error?.(error.message || 'Êõ¥Êñ∞Â§±Ë¥•ÔºåËØ∑ÈáçËØï') || console.error('Êõ¥Êñ∞Â§±Ë¥•:', error.message);\n        throw error;\n      }\n    },\n    /**\n     * ÂàùÂßãÂåñAIÂä©Êâã\n     */\n    async initializeAIAssistant() {\n      try {\n        // Ê∑ªÂä†ÁõëÂê¨Âô®ÔºåÂΩìAIÂä©Êâã‰ø°ÊÅØÊõ¥Êñ∞Êó∂ÂêåÊ≠•Âà∞ÁªÑ‰ª∂Áä∂ÊÄÅ\n        aiAssistantService.addListener(this.updateAssistantFromService);\n\n        // ÂàùÂßãÂåñAIÂä©Êâã\n        await aiAssistantService.initialize();\n        this.assistant = aiAssistantService.getCurrentAssistant();\n        log.success('AIÂä©ÊâãÂàùÂßãÂåñÂÆåÊàê:', this.assistant);\n      } catch (error) {\n        log.error('AIÂä©ÊâãÂàùÂßãÂåñÂ§±Ë¥•:', error);\n        // ÂàõÂª∫ÈªòËÆ§Âä©Êâã‰ø°ÊÅØ\n        this.assistant = {\n          id: 'default',\n          name: 'AIÂ≠¶‰π†Âä©Êâã',\n          heartValue: 0,\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString()\n        };\n      }\n    },\n    /**\n     * ‰ªéÊúçÂä°Êõ¥Êñ∞AIÂä©Êâã‰ø°ÊÅØÔºàÁõëÂê¨Âô®ÂõûË∞ÉÔºâ\n     */\n    updateAssistantFromService(assistant) {\n      this.assistant = assistant;\n      log.debug('AIÂä©Êâã‰ø°ÊÅØÂ∑≤Êõ¥Êñ∞:', assistant);\n    },\n    /**\n     * ÊòæÁ§∫ËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅ\n     */\n    showVoiceStatusBar(type, title, message, progress = 0, autoClose = 3000) {\n      this.voiceStatusType = type;\n      this.voiceStatusTitle = title;\n      this.voiceStatusMessage = message;\n      this.voiceStatusProgress = progress;\n      this.voiceStatusAutoClose = autoClose;\n      this.showVoiceStatus = true;\n      log.info('ÊòæÁ§∫ËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅ', {\n        type,\n        title,\n        message,\n        progress\n      });\n    },\n    /**\n     * ÈöêËóèËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅ\n     */\n    hideVoiceStatus() {\n      this.showVoiceStatus = false;\n      log.info('ÈöêËóèËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅ');\n    },\n    /**\n     * Êõ¥Êñ∞ËØ≠Èü≥ËØÜÂà´ËøõÂ∫¶\n     */\n    updateVoiceStatusProgress(progress) {\n      this.voiceStatusProgress = progress;\n    },\n    /**\n     * Â§ÑÁêÜAIÂõûÂ§çÔºàÂõæÁâáÂàÜÊûêÁªìÊûúÁ≠âÔºâ\n     */\n    async handleAIReply(replyContent) {\n      try {\n        log.info('Êî∂Âà∞AIÂõûÂ§ç', {\n          content: replyContent\n        });\n\n        // Áõ¥Êé•Ê∑ªÂä†AIÂõûÂ§çÂà∞Ê∂àÊÅØÂàóË°®Ôºå‰∏çËß¶ÂèëÊô∫ËÉΩË∞ÉÂ∫¶\n        await this.messageService.addAIReply(replyContent);\n\n        // Êõ¥Êñ∞Ê∂àÊÅØÂàóË°®\n        this.updateMessages();\n\n        // ÊªöÂä®Âà∞Â∫ïÈÉ®\n        this.$nextTick(() => {\n          this.scrollToBottom();\n        });\n        log.success('AIÂõûÂ§çÂ∑≤Ê∑ªÂä†');\n      } catch (error) {\n        log.error('Â§ÑÁêÜAIÂõûÂ§çÂ§±Ë¥•', error);\n        this.handleError('Â§ÑÁêÜAIÂõûÂ§çÊó∂Âá∫Áé∞ÈîôËØØÔºåËØ∑Á®çÂêéÈáçËØï');\n      }\n    },\n    /**\n     * ÁõëÂê¨ËØ≠Èü≥ËØÜÂà´ÊúçÂä°Áä∂ÊÄÅÂèòÂåñ\n     */\n    setupVoiceRecognitionListener() {\n      // ÁõëÂê¨ËØ≠Èü≥ËØÜÂà´ÊúçÂä°ÁöÑÁä∂ÊÄÅÂèòÂåñ\n      const checkStatus = () => {\n        const isProcessing = speechRecognitionService.getProcessingStatus();\n        if (isProcessing && !this.showVoiceStatus) {\n          this.showVoiceStatusBar('processing', 'ËØ≠Èü≥ËØÜÂà´‰∏≠', 'Ê≠£Âú®Â§ÑÁêÜÈü≥È¢ëÊñá‰ª∂ÔºåËØ∑Á®çÂÄô...', 0);\n        } else if (!isProcessing && this.showVoiceStatus && this.voiceStatusType === 'processing') {\n          this.hideVoiceStatus();\n        }\n      };\n\n      // ÂÆöÊúüÊ£ÄÊü•Áä∂ÊÄÅ\n      this.voiceStatusInterval = setInterval(checkStatus, 500);\n    }\n  },\n  async mounted() {\n    log.info('AIsiriÊô∫ËÉΩË∞ÉÂ∫¶Âä©ÊâãÈ°µÈù¢ÂàùÂßãÂåñ');\n    try {\n      // 1. ÂàùÂßãÂåñAIÂä©Êâã\n      await this.initializeAIAssistant();\n\n      // 2. ÂàùÂßãÂåñÊ∂àÊÅØÂàóË°®\n      this.updateMessages();\n\n      // 3. Ê£ÄÊü•ËøûÊé•Áä∂ÊÄÅ\n      await this.checkConnection();\n\n      // 4. ËÆæÁΩÆËØ≠Èü≥ËØÜÂà´ÁõëÂê¨Âô®\n      this.setupVoiceRecognitionListener();\n\n      // 5. ÊªöÂä®Âà∞Â∫ïÈÉ®\n      this.scrollToBottom();\n      log.success('AIsiriÊô∫ËÉΩË∞ÉÂ∫¶Âä©ÊâãÈ°µÈù¢ÂàùÂßãÂåñÂÆåÊàê');\n    } catch (error) {\n      log.error('È°µÈù¢ÂàùÂßãÂåñÂ§±Ë¥•', error);\n      this.handleError('ÂàùÂßãÂåñÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï');\n    }\n  },\n  beforeUnmount() {\n    log.info('AIsiriÊô∫ËÉΩË∞ÉÂ∫¶Âä©ÊâãÈ°µÈù¢Âç∏ËΩΩ');\n    // ÁßªÈô§AIÂä©ÊâãÁõëÂê¨Âô®\n    aiAssistantService.removeListener(this.updateAssistantFromService);\n\n    // Ê∏ÖÁêÜËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅÊ£ÄÊü•ÂÆöÊó∂Âô®\n    if (this.voiceStatusInterval) {\n      clearInterval(this.voiceStatusInterval);\n    }\n  },\n  watch: {\n    // ÁõëÂê¨Ê∂àÊÅØÂèòÂåñÔºåËá™Âä®ÊªöÂä®Âà∞Â∫ïÈÉ®\n    messages: {\n      handler() {\n        this.$nextTick(() => {\n          this.scrollToBottom();\n        });\n      },\n      deep: true\n    },\n    // ÁõëÂê¨ËøûÊé•Áä∂ÊÄÅÂèòÂåñ\n    connectionStatus(newStatus) {\n      log.info(`ËøûÊé•Áä∂ÊÄÅÂèòÊõ¥: ${newStatus}`);\n    }\n  },\n  computed: {\n    // ËÆ°ÁÆóÊòØÂê¶Ê≠£Âú®Â§ÑÁêÜ\n    isProcessing() {\n      return this.messageService.isCurrentlyProcessing() || this.isTyping;\n    },\n    // ËÆ°ÁÆóËøûÊé•Áä∂ÊÄÅÊòæÁ§∫\n    connectionStatusText() {\n      const statusMap = {\n        connecting: 'ËøûÊé•‰∏≠...',\n        connected: 'Â∑≤ËøûÊé•',\n        error: 'ËøûÊé•Â§±Ë¥•'\n      };\n      return statusMap[this.connectionStatus] || 'Êú™Áü•Áä∂ÊÄÅ';\n    },\n    // ËÆ°ÁÆóÊòØÂê¶ÊòæÁ§∫ÈîôËØØÁä∂ÊÄÅ\n    showError() {\n      return this.connectionStatus === 'error' && this.errorMessage;\n    }\n  }\n};","map":{"version":3,"names":["AIHeader","MessageCard","MessageInput","AssistantSettingsModal","VoiceRecognitionStatus","messageService","aisiriService","aiAssistantService","speechRecognitionService","QUICK_ACTIONS","log","name","components","data","isTyping","messages","quickActions","connectionStatus","errorMessage","assistant","showSettingsModal","showVoiceStatus","voiceStatusType","voiceStatusTitle","voiceStatusMessage","voiceStatusProgress","voiceStatusAutoClose","methods","sendMessage","message","trim","warn","user","processUserInput","updateMessages","increaseHeartValue","error","handleError","$nextTick","scrollToBottom","type","fileName","fileSize","imageUrl","addUserMessage","formatFileSize","bytes","k","sizes","i","Math","floor","parseFloat","pow","toFixed","sendVoiceMessage","voiceData","duration","transcription","processVoiceInput","sendQuickMessage","text","getMessages","debug","messageCount","length","setTimeout","checkConnection","api","response","healthCheck","success","Error","reconnect","info","clearMessages","chatContainer","document","querySelector","scrollTop","scrollHeight","exportChatHistory","history","exportMessages","table","blob","Blob","JSON","stringify","url","URL","createObjectURL","a","createElement","href","download","Date","toISOString","slice","click","revokeObjectURL","openSettingsModal","closeSettingsModal","saveAssistantSettings","newName","updateAssistantName","$toast","console","initializeAIAssistant","addListener","updateAssistantFromService","initialize","getCurrentAssistant","id","heartValue","createdAt","updatedAt","showVoiceStatusBar","title","progress","autoClose","hideVoiceStatus","updateVoiceStatusProgress","handleAIReply","replyContent","content","addAIReply","setupVoiceRecognitionListener","checkStatus","isProcessing","getProcessingStatus","voiceStatusInterval","setInterval","mounted","beforeUnmount","removeListener","clearInterval","watch","handler","deep","newStatus","computed","isCurrentlyProcessing","connectionStatusText","statusMap","connecting","connected","showError"],"sources":["/root/timer/src/views/AiSecretary.vue"],"sourcesContent":["<template>\n  <div class=\"ai-secretary-container\">\n    <AIHeader \n      :assistant=\"assistant\" \n      @openSettings=\"openSettingsModal\" \n    />\n    \n    <!-- ËøûÊé•Áä∂ÊÄÅÊòæÁ§∫ -->\n    <div v-if=\"connectionStatus === 'connecting'\" class=\"connection-status connecting\">\n      <font-awesome-icon icon=\"spinner\" spin />\n      <span>{{ connectionStatusText }}</span>\n    </div>\n    \n    <!-- ÈîôËØØÊèêÁ§∫ -->\n    <div v-if=\"showError\" class=\"error-banner\" @click=\"reconnect\">\n      <font-awesome-icon icon=\"exclamation-circle\" />\n      <span>{{ errorMessage }}</span>\n      <small>ÁÇπÂáªÈáçËØï</small>\n    </div>\n    \n    <div class=\"chat-container\">\n      <MessageCard \n        v-for=\"message in messages\" \n        :key=\"message.id\"\n        :message=\"message\"\n      />\n      \n      <!-- Typing indicator -->\n      <div v-if=\"isProcessing\" class=\"message ai-message\">\n        <div class=\"avatar\">\n          <font-awesome-icon icon=\"robot\" />\n        </div>\n        <div class=\"message-content\">\n          <div class=\"typing-indicator\">\n            <span></span>\n            <span></span>\n            <span></span>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Quick Actions -->\n    <div class=\"quick-actions\">\n      <button \n        v-for=\"action in quickActions\"\n        :key=\"action.id\"\n        class=\"quick-action-btn\"\n        @click=\"sendQuickMessage(action.text)\"\n      >\n        <font-awesome-icon :icon=\"action.icon\" />\n        <span>{{ action.label }}</span>\n      </button>\n    </div>\n    \n    <MessageInput @sendMessage=\"sendMessage\" @sendVoiceMessage=\"sendVoiceMessage\" @aiReply=\"handleAIReply\" />\n    \n    <!-- AIÂä©ÊâãËÆæÁΩÆÊ®°ÊÄÅÊ°Ü -->\n    <AssistantSettingsModal\n      :visible=\"showSettingsModal\"\n      :assistant=\"assistant\"\n      @close=\"closeSettingsModal\"\n      @save=\"saveAssistantSettings\"\n    />\n\n    <!-- ËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅÁªÑ‰ª∂ -->\n    <VoiceRecognitionStatus\n      :show=\"showVoiceStatus\"\n      :type=\"voiceStatusType\"\n      :title=\"voiceStatusTitle\"\n      :message=\"voiceStatusMessage\"\n      :progress=\"voiceStatusProgress\"\n      :auto-close=\"voiceStatusAutoClose\"\n      @close=\"hideVoiceStatus\"\n    />\n\n  </div>\n</template>\n\n<script>\nimport AIHeader from '../components/AIsecretary/Header.vue'\nimport MessageCard from '../components/AIsecretary/MessageCard.vue'\nimport MessageInput from '../components/AIsecretary/MessageInput.vue'\nimport AssistantSettingsModal from '../components/AIsecretary/AssistantSettingsModal.vue'\nimport VoiceRecognitionStatus from '../components/AIsecretary/VoiceRecognitionStatus.vue'\n\n// ÂØºÂÖ•AIÊúçÂä°\nimport messageService from '../AIsiri/services/messageService.js'\nimport aisiriService from '../AIsiri/services/aiApi.js'\nimport aiAssistantService from '../AIsiri/services/aiAssistantService.js'\nimport speechRecognitionService from '../AIsiri/services/speechRecognitionService.js'\nimport { QUICK_ACTIONS } from '../AIsiri/types/index.js'\nimport { log } from '../AIsiri/utils/logger.js'\n\nexport default {\n  name: 'AiSecretary',\n  components: {\n    AIHeader,\n    MessageCard,\n    MessageInput,\n    AssistantSettingsModal,\n    VoiceRecognitionStatus\n  },\n  data() {\n    return {\n      isTyping: false,\n      messages: [],\n      quickActions: QUICK_ACTIONS,\n      messageService: messageService,\n      // Ê∑ªÂä†ËøûÊé•Áä∂ÊÄÅ\n      connectionStatus: 'connecting', // connecting, connected, error\n      // Ê∑ªÂä†ÈîôËØØ‰ø°ÊÅØ\n      errorMessage: null,\n      // AIÂä©ÊâãÁõ∏ÂÖ≥\n      assistant: null,\n      showSettingsModal: false,\n      // ËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅ\n      showVoiceStatus: false,\n      voiceStatusType: 'processing',\n      voiceStatusTitle: '',\n      voiceStatusMessage: '',\n      voiceStatusProgress: 0,\n      voiceStatusAutoClose: 3000\n    }\n  },\n  methods: {\n    /**\n     * ÂèëÈÄÅÊ∂àÊÅØ\n     */\n    async sendMessage(message) {\n      // Ê£ÄÊü•Ê∂àÊÅØÁ±ªÂûã\n      if (typeof message === 'string') {\n        // ÊñáÊú¨Ê∂àÊÅØ\n        if (!message || !message.trim()) {\n          log.warn('ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•ÔºöÊ∂àÊÅØÂÜÖÂÆπ‰∏∫Á©∫')\n          return\n        }\n\n        try {\n          log.user('ÂèëÈÄÅÊñáÊú¨Ê∂àÊÅØ', { message: message })\n          \n          // ÊòæÁ§∫ÊâìÂ≠óÁä∂ÊÄÅ\n          this.isTyping = true\n          \n          // Â§ÑÁêÜÁî®Êà∑ËæìÂÖ• - ‰ΩøÁî®Êô∫ËÉΩË∞ÉÂ∫¶Á≥ªÁªü\n          await this.messageService.processUserInput(message.trim())\n          \n          // Êõ¥Êñ∞Ê∂àÊÅØÂàóË°®\n          this.updateMessages()\n          \n          // Â¢ûÂä†ÂøÉÂä®ÂÄº\n          await this.increaseHeartValue()\n          \n        } catch (error) {\n          log.error('ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•', error)\n          this.handleError('ÂèëÈÄÅÊ∂àÊÅØÊó∂Âá∫Áé∞ÈîôËØØÔºåËØ∑Á®çÂêéÈáçËØï')\n        } finally {\n          this.isTyping = false\n          this.$nextTick(() => {\n            this.scrollToBottom()\n          })\n        }\n      } else if (message && message.type === 'image') {\n        // ÂõæÁâáÊ∂àÊÅØ\n        try {\n          log.user('ÂèëÈÄÅÂõæÁâáÊ∂àÊÅØ', { \n            fileName: message.fileName, \n            fileSize: message.fileSize,\n            imageUrl: message.imageUrl \n          })\n          \n          // Áõ¥Êé•Ê∑ªÂä†Áî®Êà∑ÂõæÁâáÊ∂àÊÅØÂà∞Ê∂àÊÅØÂàóË°®Ôºå‰∏çËß¶ÂèëÊô∫ËÉΩË∞ÉÂ∫¶\n          await this.messageService.addUserMessage(`üñºÔ∏è ÂõæÁâáÔºö${message.fileName} (${this.formatFileSize(message.fileSize)})`, 'IMAGE', { imageUrl: message.imageUrl })\n          \n          // Êõ¥Êñ∞Ê∂àÊÅØÂàóË°®\n          this.updateMessages()\n          \n          // ÊªöÂä®Âà∞Â∫ïÈÉ®\n          this.$nextTick(() => {\n            this.scrollToBottom()\n          })\n          \n        } catch (error) {\n          log.error('ÂèëÈÄÅÂõæÁâáÊ∂àÊÅØÂ§±Ë¥•', error)\n          this.handleError('ÂèëÈÄÅÂõæÁâáÊ∂àÊÅØÊó∂Âá∫Áé∞ÈîôËØØÔºåËØ∑Á®çÂêéÈáçËØï')\n        }\n      } else {\n        log.warn('ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•ÔºöÊó†ÊïàÁöÑÊ∂àÊÅØÊ†ºÂºè')\n        return\n      }\n    },\n\n    /**\n     * Ê†ºÂºèÂåñÊñá‰ª∂Â§ßÂ∞è\n     */\n    formatFileSize(bytes) {\n      if (bytes === 0) return '0 Bytes';\n      const k = 1024;\n      const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n      const i = Math.floor(Math.log(bytes) / Math.log(k));\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n    },\n\n    /**\n     * ÂèëÈÄÅËØ≠Èü≥Ê∂àÊÅØ\n     */\n    async sendVoiceMessage(voiceData) {\n      try {\n        log.user('ÂèëÈÄÅËØ≠Èü≥Ê∂àÊÅØ', { \n          duration: voiceData.duration,\n          transcription: voiceData.transcription \n        })\n        \n        // Â¶ÇÊûúÊúâËØÜÂà´ÊñáÊú¨ÔºåÂèëÈÄÅÂà∞AIÂä©Êâã\n        if (voiceData.transcription) {\n          // ÊòæÁ§∫Â§ÑÁêÜÁä∂ÊÄÅ\n          this.isTyping = true;\n          \n          // ‰ΩøÁî®Ê∂àÊÅØÊúçÂä°ÁöÑËØ≠Èü≥Â§ÑÁêÜÊñπÊ≥ïÔºà‰ºöËá™Âä®Ê∑ªÂä†Áî®Êà∑ËØ≠Èü≥Ê∂àÊÅØÔºâ\n          await this.messageService.processVoiceInput(voiceData);\n          \n          // Êõ¥Êñ∞Ê∂àÊÅØÂàóË°®\n          this.updateMessages();\n          \n          // Â¢ûÂä†ÂøÉÂä®ÂÄº\n          await this.increaseHeartValue();\n        }\n        \n      } catch (error) {\n        log.error('ÂèëÈÄÅËØ≠Èü≥Ê∂àÊÅØÂ§±Ë¥•', error);\n        this.handleError('ÂèëÈÄÅËØ≠Èü≥Ê∂àÊÅØÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');\n      } finally {\n        this.isTyping = false;\n        this.$nextTick(() => {\n          this.scrollToBottom();\n        });\n      }\n    },\n\n\n\n    /**\n     * ÂèëÈÄÅÂø´ÈÄüÊ∂àÊÅØ\n     */\n    async sendQuickMessage(text) {\n      log.user('‰ΩøÁî®Âø´ÈÄüÊìç‰Ωú', { message: text })\n      await this.sendMessage(text)\n    },\n\n    /**\n     * Êõ¥Êñ∞Ê∂àÊÅØÂàóË°®\n     */\n    updateMessages() {\n      this.messages = this.messageService.getMessages()\n      log.debug('Ê∂àÊÅØÂàóË°®Â∑≤Êõ¥Êñ∞', { messageCount: this.messages.length })\n    },\n\n    /**\n     * Â§ÑÁêÜÈîôËØØ\n     */\n    handleError(message) {\n      this.errorMessage = message\n      this.connectionStatus = 'error'\n      \n      // 3ÁßíÂêéËá™Âä®Ê∏ÖÈô§ÈîôËØØ‰ø°ÊÅØ\n      setTimeout(() => {\n        this.errorMessage = null\n        this.connectionStatus = 'connected'\n      }, 3000)\n    },\n\n    /**\n     * Ê£ÄÊü•ËøûÊé•Áä∂ÊÄÅ\n     */\n    async checkConnection() {\n      try {\n        log.api('Ê£ÄÊü•AIsiriÊô∫ËÉΩË∞ÉÂ∫¶ÊúçÂä°ËøûÊé•Áä∂ÊÄÅ')\n        this.connectionStatus = 'connecting'\n        \n        const response = await aisiriService.healthCheck()\n        \n        if (response.success) {\n          this.connectionStatus = 'connected'\n          log.success('AIsiriÊô∫ËÉΩË∞ÉÂ∫¶ÊúçÂä°ËøûÊé•Ê≠£Â∏∏')\n        } else {\n          throw new Error('ÂÅ•Â∫∑Ê£ÄÊü•Â§±Ë¥•')\n        }\n        \n      } catch (error) {\n        log.error('ËøûÊé•Ê£ÄÊü•Â§±Ë¥•', error)\n        this.connectionStatus = 'error'\n        this.errorMessage = 'Êó†Ê≥ïËøûÊé•Âà∞AIsiriÊô∫ËÉΩË∞ÉÂ∫¶ÊúçÂä°ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•'\n      }\n    },\n\n    /**\n     * ÈáçÊñ∞ËøûÊé•\n     */\n    async reconnect() {\n      log.info('Â∞ùËØïÈáçÊñ∞ËøûÊé•AIsiriÊô∫ËÉΩË∞ÉÂ∫¶ÊúçÂä°')\n      await this.checkConnection()\n    },\n\n    /**\n     * Ê∏ÖÈô§ÊâÄÊúâÊ∂àÊÅØ\n     */\n    clearMessages() {\n      log.user('Ê∏ÖÈô§Ê∂àÊÅØÂéÜÂè≤')\n      this.messageService.clearMessages()\n      this.updateMessages()\n    },\n\n    /**\n     * ÊªöÂä®Âà∞Â∫ïÈÉ®\n     */\n    scrollToBottom() {\n      this.$nextTick(() => {\n        const chatContainer = document.querySelector('.chat-container')\n        if (chatContainer) {\n          chatContainer.scrollTop = chatContainer.scrollHeight\n        }\n      })\n    },\n\n    /**\n     * ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩïÔºàË∞ÉËØïÁî®Ôºâ\n     */\n    exportChatHistory() {\n      const history = this.messageService.exportMessages()\n      log.table(history, 'ËÅäÂ§©ËÆ∞ÂΩïÂØºÂá∫')\n      \n      // ‰∏ãËΩΩ‰∏∫JSONÊñá‰ª∂\n      const blob = new Blob([JSON.stringify(history, null, 2)], { type: 'application/json' })\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = `aisiri_chat_history_${new Date().toISOString().slice(0, 10)}.json`\n      a.click()\n      URL.revokeObjectURL(url)\n    },\n\n    /**\n     * Â¢ûÂä†ÂøÉÂä®ÂÄº\n     */\n    async increaseHeartValue() {\n      try {\n        await aiAssistantService.increaseHeartValue()\n        log.info('ÂøÉÂä®ÂÄºÂ¢ûÂä†ÊàêÂäü')\n      } catch (error) {\n        log.error('Â¢ûÂä†ÂøÉÂä®ÂÄºÂ§±Ë¥•:', error)\n        // ‰∏çÂΩ±Âìç‰∏ªË¶ÅÂäüËÉΩÔºåÂè™ËÆ∞ÂΩïÈîôËØØ\n      }\n    },\n\n    /**\n     * ÊâìÂºÄËÆæÁΩÆÊ®°ÊÄÅÊ°Ü\n     */\n    openSettingsModal() {\n      this.showSettingsModal = true\n    },\n\n    /**\n     * ÂÖ≥Èó≠ËÆæÁΩÆÊ®°ÊÄÅÊ°Ü\n     */\n    closeSettingsModal() {\n      this.showSettingsModal = false\n    },\n\n    /**\n     * ‰øùÂ≠òAIÂä©ÊâãËÆæÁΩÆ\n     */\n    async saveAssistantSettings(newName) {\n      try {\n        await aiAssistantService.updateAssistantName(newName)\n        log.success('AIÂä©ÊâãÂêçÁß∞Êõ¥Êñ∞ÊàêÂäü:', newName)\n        // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫\n        this.$toast?.success?.(`AIÂä©ÊâãÂêçÁß∞Â∑≤Êõ¥Êñ∞‰∏∫\"${newName}\"`) || \n        console.log(`AIÂä©ÊâãÂêçÁß∞Â∑≤Êõ¥Êñ∞‰∏∫\"${newName}\"`)\n      } catch (error) {\n        log.error('Êõ¥Êñ∞AIÂä©ÊâãÂêçÁß∞Â§±Ë¥•:', error)\n        // ÊòæÁ§∫ÈîôËØØÊèêÁ§∫\n        this.$toast?.error?.(error.message || 'Êõ¥Êñ∞Â§±Ë¥•ÔºåËØ∑ÈáçËØï') || \n        console.error('Êõ¥Êñ∞Â§±Ë¥•:', error.message)\n        throw error\n      }\n    },\n\n    /**\n     * ÂàùÂßãÂåñAIÂä©Êâã\n     */\n    async initializeAIAssistant() {\n      try {\n        // Ê∑ªÂä†ÁõëÂê¨Âô®ÔºåÂΩìAIÂä©Êâã‰ø°ÊÅØÊõ¥Êñ∞Êó∂ÂêåÊ≠•Âà∞ÁªÑ‰ª∂Áä∂ÊÄÅ\n        aiAssistantService.addListener(this.updateAssistantFromService)\n        \n        // ÂàùÂßãÂåñAIÂä©Êâã\n        await aiAssistantService.initialize()\n        this.assistant = aiAssistantService.getCurrentAssistant()\n        \n        log.success('AIÂä©ÊâãÂàùÂßãÂåñÂÆåÊàê:', this.assistant)\n      } catch (error) {\n        log.error('AIÂä©ÊâãÂàùÂßãÂåñÂ§±Ë¥•:', error)\n        // ÂàõÂª∫ÈªòËÆ§Âä©Êâã‰ø°ÊÅØ\n        this.assistant = {\n          id: 'default',\n          name: 'AIÂ≠¶‰π†Âä©Êâã',\n          heartValue: 0,\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString()\n        }\n      }\n    },\n\n    /**\n     * ‰ªéÊúçÂä°Êõ¥Êñ∞AIÂä©Êâã‰ø°ÊÅØÔºàÁõëÂê¨Âô®ÂõûË∞ÉÔºâ\n     */\n    updateAssistantFromService(assistant) {\n      this.assistant = assistant\n      log.debug('AIÂä©Êâã‰ø°ÊÅØÂ∑≤Êõ¥Êñ∞:', assistant)\n    },\n\n    /**\n     * ÊòæÁ§∫ËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅ\n     */\n    showVoiceStatusBar(type, title, message, progress = 0, autoClose = 3000) {\n      this.voiceStatusType = type\n      this.voiceStatusTitle = title\n      this.voiceStatusMessage = message\n      this.voiceStatusProgress = progress\n      this.voiceStatusAutoClose = autoClose\n      this.showVoiceStatus = true\n      \n      log.info('ÊòæÁ§∫ËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅ', { type, title, message, progress })\n    },\n\n    /**\n     * ÈöêËóèËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅ\n     */\n    hideVoiceStatus() {\n      this.showVoiceStatus = false\n      log.info('ÈöêËóèËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅ')\n    },\n\n    /**\n     * Êõ¥Êñ∞ËØ≠Èü≥ËØÜÂà´ËøõÂ∫¶\n     */\n    updateVoiceStatusProgress(progress) {\n      this.voiceStatusProgress = progress\n    },\n\n    /**\n     * Â§ÑÁêÜAIÂõûÂ§çÔºàÂõæÁâáÂàÜÊûêÁªìÊûúÁ≠âÔºâ\n     */\n    async handleAIReply(replyContent) {\n      try {\n        log.info('Êî∂Âà∞AIÂõûÂ§ç', { content: replyContent })\n        \n        // Áõ¥Êé•Ê∑ªÂä†AIÂõûÂ§çÂà∞Ê∂àÊÅØÂàóË°®Ôºå‰∏çËß¶ÂèëÊô∫ËÉΩË∞ÉÂ∫¶\n        await this.messageService.addAIReply(replyContent)\n        \n        // Êõ¥Êñ∞Ê∂àÊÅØÂàóË°®\n        this.updateMessages()\n        \n        // ÊªöÂä®Âà∞Â∫ïÈÉ®\n        this.$nextTick(() => {\n          this.scrollToBottom()\n        })\n        \n        log.success('AIÂõûÂ§çÂ∑≤Ê∑ªÂä†')\n        \n      } catch (error) {\n        log.error('Â§ÑÁêÜAIÂõûÂ§çÂ§±Ë¥•', error)\n        this.handleError('Â§ÑÁêÜAIÂõûÂ§çÊó∂Âá∫Áé∞ÈîôËØØÔºåËØ∑Á®çÂêéÈáçËØï')\n      }\n    },\n\n    /**\n     * ÁõëÂê¨ËØ≠Èü≥ËØÜÂà´ÊúçÂä°Áä∂ÊÄÅÂèòÂåñ\n     */\n    setupVoiceRecognitionListener() {\n      // ÁõëÂê¨ËØ≠Èü≥ËØÜÂà´ÊúçÂä°ÁöÑÁä∂ÊÄÅÂèòÂåñ\n      const checkStatus = () => {\n        const isProcessing = speechRecognitionService.getProcessingStatus()\n        \n        if (isProcessing && !this.showVoiceStatus) {\n          this.showVoiceStatusBar(\n            'processing',\n            'ËØ≠Èü≥ËØÜÂà´‰∏≠',\n            'Ê≠£Âú®Â§ÑÁêÜÈü≥È¢ëÊñá‰ª∂ÔºåËØ∑Á®çÂÄô...',\n            0\n          )\n        } else if (!isProcessing && this.showVoiceStatus && this.voiceStatusType === 'processing') {\n          this.hideVoiceStatus()\n        }\n      }\n      \n      // ÂÆöÊúüÊ£ÄÊü•Áä∂ÊÄÅ\n      this.voiceStatusInterval = setInterval(checkStatus, 500)\n    }\n  },\n  async mounted() {\n    log.info('AIsiriÊô∫ËÉΩË∞ÉÂ∫¶Âä©ÊâãÈ°µÈù¢ÂàùÂßãÂåñ')\n    \n    try {\n      // 1. ÂàùÂßãÂåñAIÂä©Êâã\n      await this.initializeAIAssistant()\n      \n      // 2. ÂàùÂßãÂåñÊ∂àÊÅØÂàóË°®\n      this.updateMessages()\n      \n      // 3. Ê£ÄÊü•ËøûÊé•Áä∂ÊÄÅ\n      await this.checkConnection()\n      \n      // 4. ËÆæÁΩÆËØ≠Èü≥ËØÜÂà´ÁõëÂê¨Âô®\n      this.setupVoiceRecognitionListener()\n      \n      // 5. ÊªöÂä®Âà∞Â∫ïÈÉ®\n      this.scrollToBottom()\n      \n      log.success('AIsiriÊô∫ËÉΩË∞ÉÂ∫¶Âä©ÊâãÈ°µÈù¢ÂàùÂßãÂåñÂÆåÊàê')\n      \n    } catch (error) {\n      log.error('È°µÈù¢ÂàùÂßãÂåñÂ§±Ë¥•', error)\n      this.handleError('ÂàùÂßãÂåñÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï')\n    }\n  },\n  \n  beforeUnmount() {\n    log.info('AIsiriÊô∫ËÉΩË∞ÉÂ∫¶Âä©ÊâãÈ°µÈù¢Âç∏ËΩΩ')\n    // ÁßªÈô§AIÂä©ÊâãÁõëÂê¨Âô®\n    aiAssistantService.removeListener(this.updateAssistantFromService)\n    \n    // Ê∏ÖÁêÜËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅÊ£ÄÊü•ÂÆöÊó∂Âô®\n    if (this.voiceStatusInterval) {\n      clearInterval(this.voiceStatusInterval)\n    }\n  },\n  \n  watch: {\n    // ÁõëÂê¨Ê∂àÊÅØÂèòÂåñÔºåËá™Âä®ÊªöÂä®Âà∞Â∫ïÈÉ®\n    messages: {\n      handler() {\n        this.$nextTick(() => {\n          this.scrollToBottom()\n        })\n      },\n      deep: true\n    },\n    \n    // ÁõëÂê¨ËøûÊé•Áä∂ÊÄÅÂèòÂåñ\n    connectionStatus(newStatus) {\n      log.info(`ËøûÊé•Áä∂ÊÄÅÂèòÊõ¥: ${newStatus}`)\n    }\n  },\n  \n  computed: {\n    // ËÆ°ÁÆóÊòØÂê¶Ê≠£Âú®Â§ÑÁêÜ\n    isProcessing() {\n      return this.messageService.isCurrentlyProcessing() || this.isTyping\n    },\n    \n    // ËÆ°ÁÆóËøûÊé•Áä∂ÊÄÅÊòæÁ§∫\n    connectionStatusText() {\n      const statusMap = {\n        connecting: 'ËøûÊé•‰∏≠...',\n        connected: 'Â∑≤ËøûÊé•',\n        error: 'ËøûÊé•Â§±Ë¥•'\n      }\n      return statusMap[this.connectionStatus] || 'Êú™Áü•Áä∂ÊÄÅ'\n    },\n    \n    // ËÆ°ÁÆóÊòØÂê¶ÊòæÁ§∫ÈîôËØØÁä∂ÊÄÅ\n    showError() {\n      return this.connectionStatus === 'error' && this.errorMessage\n    }\n  }\n}\n</script>\n\n<style scoped>\n:root {\n    --primary-bg: #f7f7f7;\n    --chat-bg: #f7f7f7;\n    --white: #ffffff;\n    --text-primary: #000000;\n    --text-secondary: #666666;\n    --text-time: #999999;\n    --blue: #007aff;\n    --green: #07c160;\n    --border: #e5e5e5;\n    --shadow: 0 1px 3px rgba(0,0,0,0.1);\n    --shadow-up: 0 -1px 3px rgba(0,0,0,0.1);\n}\n\n.ai-secretary-container {\n  height: 100vh;\n  background: var(--primary-bg);\n  display: flex;\n  flex-direction: column;\n}\n\n.chat-container {\n  flex: 1;\n  overflow-y: auto;\n  padding: 16px;\n  padding-bottom: 160px; /* Adjust for input and quick actions */\n}\n\n.message {\n  display: flex;\n  margin-bottom: 16px;\n  animation: fadeIn 0.3s ease-in;\n}\n\n.ai-message {\n  justify-content: flex-start;\n}\n\n.user-message {\n  justify-content: flex-end;\n}\n\n.avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 20px;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  margin-right: 12px;\n  flex-shrink: 0;\n}\n\n.user-avatar {\n  background: linear-gradient(135deg, #34c759 0%, #30d158 100%);\n  margin-right: 0;\n  margin-left: 12px;\n}\n\n.message-content {\n  max-width: 80%;\n  background: rgba(255, 255, 255, 0.95);\n  backdrop-filter: blur(10px);\n  border-radius: 16px;\n  padding: 12px 16px;\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.user-message .message-content {\n  background: rgba(0, 122, 255, 0.9);\n  backdrop-filter: blur(10px);\n  border: 1px solid rgba(0, 122, 255, 0.3);\n  color: white;\n}\n\n.message-text {\n  font-size: 16px;\n  line-height: 1.4;\n  word-wrap: break-word;\n}\n\n.typing-indicator {\n  display: flex;\n  gap: 4px;\n}\n\n.typing-indicator span {\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  background: #8e8e93;\n  animation: typing 1.4s infinite ease-in-out;\n}\n\n.typing-indicator span:nth-child(1) { animation-delay: -0.32s; }\n.typing-indicator span:nth-child(2) { animation-delay: -0.16s; }\n\n.quick-actions {\n  position: fixed;\n  bottom: 85px;\n  left: 16px;\n  display: flex;\n  gap: 12px;\n  overflow-x: auto;\n  background: transparent;\n  max-width: calc(100% - 32px);\n  padding: 8px 0;\n  /* ÈöêËóèÊªöÂä®Êù° */\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none; /* IE 10+ */\n  scroll-behavior: smooth;\n}\n\n.quick-actions::-webkit-scrollbar {\n  display: none; /* Chrome, Safari, Edge */\n}\n\n.quick-action-btn {\n  pointer-events: all;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 4px;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.95);\n  backdrop-filter: blur(10px);\n  border: none;\n  border-radius: 20px;\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  min-width: 88px;\n  height: 76px;\n  flex-shrink: 0;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.quick-action-btn:hover {\n  transform: translateY(-4px) scale(1.02);\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);\n  background: rgba(255, 255, 255, 1);\n}\n\n.quick-action-btn:active {\n  transform: translateY(-1px) scale(0.98);\n}\n\n.quick-action-btn > svg {\n  font-size: 22px;\n  color: #4a90e2;\n  margin-bottom: 2px;\n  transition: color 0.2s ease;\n}\n\n.quick-action-btn:hover > svg {\n  color: #007aff;\n}\n\n.quick-action-btn span {\n  font-size: 12px;\n  font-weight: 600;\n  color: #1d1d1f;\n  text-align: center;\n  line-height: 1.2;\n  white-space: nowrap;\n}\n\n\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes typing {\n  0%, 80%, 100% {\n    transform: scale(0);\n  }\n  40% {\n    transform: scale(1);\n  }\n}\n\n/* ËøûÊé•Áä∂ÊÄÅÊ†∑Âºè */\n.connection-status {\n  padding: 8px 16px;\n  background: #f8f9fa;\n  border-bottom: 1px solid #e9ecef;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 14px;\n  color: #6c757d;\n}\n\n.connection-status.connecting {\n  background: #e3f2fd;\n  color: #1976d2;\n}\n\n.connection-status svg {\n  font-size: 16px;\n}\n\n/* ÈîôËØØÊ®™ÂπÖÊ†∑Âºè */\n.error-banner {\n  padding: 12px 16px;\n  background: #ffebee;\n  border-bottom: 1px solid #ffcdd2;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  transition: background 0.2s;\n}\n\n.error-banner:hover {\n  background: #ffcdd2;\n}\n\n.error-banner svg {\n  color: #d32f2f;\n  font-size: 16px;\n}\n\n.error-banner span {\n  flex: 1;\n  color: #d32f2f;\n  font-weight: 500;\n}\n\n.error-banner small {\n  color: #757575;\n  font-size: 12px;\n}\n\n@media (max-width: 430px) {\n  .chat-container {\n    padding: 16px;\n    padding-bottom: 160px;\n  }\n  \n  .message-content {\n    max-width: 85%;\n  }\n  \n  .quick-actions {\n    bottom: 80px; /* Adjust for smaller screens */\n    left: 12px;\n    max-width: calc(100% - 24px);\n    gap: 10px;\n  }\n  \n\n  \n  .quick-action-btn {\n    min-width: 80px;\n    height: 72px;\n    padding: 10px 12px;\n    border-radius: 16px;\n  }\n  \n  .quick-action-btn > svg {\n    font-size: 20px;\n  }\n  \n  .quick-action-btn span {\n    font-size: 11px;\n    font-weight: 500;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}