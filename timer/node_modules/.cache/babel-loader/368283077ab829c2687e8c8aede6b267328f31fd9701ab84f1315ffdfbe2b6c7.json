{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport CalendarCell from '../components/calendar/CalendarCell.vue';\nimport TaskItem from '../components/common/TaskItem.vue';\nimport TabBar from '../components/common/TabBar.vue';\nimport api from '../api';\nimport { playRandomVoice } from '@/aivoice/voicePlayer.js';\nexport default {\n  name: 'CalendarView',\n  components: {\n    CalendarCell,\n    TaskItem,\n    TabBar\n  },\n  data() {\n    return {\n      currentView: 'week',\n      selectedDate: new Date(),\n      currentDate: new Date(),\n      weekDays: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],\n      tasks: [],\n      loading: false,\n      error: null\n    };\n  },\n  created() {\n    this.fetchTasks();\n  },\n  activated() {\n    this.fetchTasks();\n  },\n  computed: {\n    currentUserId() {\n      const user = JSON.parse(localStorage.getItem('user') || 'null');\n      return user?._id || user?.id || null;\n    },\n    periodLabel() {\n      if (this.currentView === 'week') {\n        const startOfWeek = this.getStartOfWeek(this.currentDate);\n        const endOfWeek = new Date(startOfWeek.getTime() + 6 * 24 * 60 * 60 * 1000);\n        return `${this.formatDate(startOfWeek)} - ${this.formatDate(endOfWeek)}`;\n      } else {\n        return `${this.currentDate.getFullYear()}年${this.currentDate.getMonth() + 1}月`;\n      }\n    },\n    weekDates() {\n      const startOfWeek = this.getStartOfWeek(this.currentDate);\n      const dates = [];\n      for (let i = 0; i < 7; i++) {\n        const date = new Date(startOfWeek.getTime() + i * 24 * 60 * 60 * 1000);\n        dates.push(date);\n      }\n      return dates;\n    },\n    monthDates() {\n      const startOfMonth = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), 1);\n\n      // Get start of week for first day of month\n      const startDate = this.getStartOfWeek(startOfMonth);\n\n      // Get end date (6 weeks worth of days)\n      const dates = [];\n      for (let i = 0; i < 42; i++) {\n        const date = new Date(startDate.getTime() + i * 24 * 60 * 60 * 1000);\n        dates.push(date);\n      }\n      return dates;\n    },\n    daySections() {\n      const d = this.selectedDate;\n      return [{\n        date: d.toDateString(),\n        title: '所选日期',\n        dateText: this.formatDateText(d),\n        tasks: this.getTasksForDate(d)\n      }];\n    }\n  },\n  watch: {\n    currentView() {\n      this.fetchTasks();\n    },\n    currentDate() {\n      // 切换周/月的周期时刷新\n      this.fetchTasks();\n    },\n    selectedDate() {\n      if (this.currentView === 'week') {\n        // 同步周内切换日期也刷新一次，避免缓存陈旧\n        this.fetchTasks();\n      }\n    }\n  },\n  methods: {\n    async fetchTasks() {\n      this.loading = true;\n      this.error = null;\n      try {\n        const userId = this.currentUserId;\n        if (!userId) {\n          this.error = '未登录，无法获取任务';\n          this.loading = false;\n          return;\n        }\n        // 优先按周期逐日拉取，保证日期精准映射\n        if (this.currentView === 'week') {\n          const dates = this.weekDates;\n          this.tasks = await this.fetchTasksForDates(userId, dates);\n        } else {\n          const dates = this.getMonthDays(this.currentDate);\n          this.tasks = await this.fetchTasksForDates(userId, dates);\n        }\n      } catch (err) {\n        console.error('[Calendar] 获取任务失败', err);\n        this.error = '获取任务失败';\n      } finally {\n        this.loading = false;\n      }\n    },\n    async fetchTasksForDates(userId, dateObjs) {\n      const uniqueDays = Array.from(new Set(dateObjs.map(d => this.formatYmd(d))));\n      const requests = uniqueDays.map(dateStr => api.tasks.getAllTasks({\n        userId,\n        date: dateStr\n      }).then(res => ({\n        res,\n        dateStr\n      })).catch(() => ({\n        res: null,\n        dateStr\n      })));\n      const results = await Promise.all(requests);\n      const merged = [];\n      const seen = new Set();\n      results.forEach(({\n        res,\n        dateStr\n      }) => {\n        let list = [];\n        if (res && res.success && Array.isArray(res.data)) list = res.data;else if (res && res.data && Array.isArray(res.data.data)) list = res.data.data;else if (Array.isArray(res)) list = res;\n        list.map(raw => this.normalizeTask(raw)).forEach(t => {\n          if (!t) return;\n          if (!t.date) t.date = this.parseToLocalDate(dateStr);\n          const key = `${t.id}`;\n          if (!seen.has(key)) {\n            seen.add(key);\n            merged.push(t);\n          } else {\n            // 如果已存在但没有日期，补日期\n            const idx = merged.findIndex(x => `${x.id}` === key);\n            if (idx >= 0 && !merged[idx].date) merged[idx].date = this.parseToLocalDate(dateStr);\n          }\n        });\n      });\n      return merged;\n    },\n    getMonthDays(anchor) {\n      const y = anchor.getFullYear();\n      const m = anchor.getMonth();\n      const daysInMonth = new Date(y, m + 1, 0).getDate();\n      const arr = [];\n      for (let i = 1; i <= daysInMonth; i++) {\n        arr.push(new Date(y, m, i));\n      }\n      return arr;\n    },\n    formatYmd(d) {\n      const y = d.getFullYear();\n      const m = String(d.getMonth() + 1).padStart(2, '0');\n      const day = String(d.getDate()).padStart(2, '0');\n      return `${y}-${m}-${day}`;\n    },\n    normalizeTask(raw) {\n      if (!raw) return null;\n      const id = raw._id || raw.id;\n      const title = raw.title || raw.name || '';\n      const completed = !!raw.completed;\n      const priority = raw.priority || 'medium';\n      // 处理时间显示：若有 time 则展示为 \"HH:MM - HH:MM+1h\"，否则为空\n      let timeDisplay = '';\n      if (typeof raw.time === 'string' && raw.time.trim()) {\n        timeDisplay = raw.time;\n      } else if (raw.startTime && raw.endTime) {\n        // 兼容可能存在的开始/结束时间字段\n        timeDisplay = `${this.formatTime(raw.startTime)} - ${this.formatTime(raw.endTime)}`;\n      }\n      // 处理日期：优先 raw.date，其次 raw.startTime，再次 raw.createdAt，否则丢弃（避免破坏日历统计）\n      let dateObj = null;\n      if (raw.date) {\n        dateObj = this.parseToLocalDate(raw.date);\n      } else if (raw.startTime) {\n        dateObj = this.parseToLocalDate(raw.startTime);\n      } else if (raw.createdAt) {\n        dateObj = this.parseToLocalDate(raw.createdAt);\n      }\n      if (!id || !title) return null;\n      return {\n        id,\n        title,\n        time: timeDisplay,\n        date: dateObj,\n        priority,\n        completed\n      };\n    },\n    parseToLocalDate(input) {\n      if (!input) return null;\n      if (input instanceof Date) return input;\n      // 处理 'YYYY-MM-DD' 或 ISO 字符串\n      try {\n        if (typeof input === 'string' && /^\\d{4}-\\d{2}-\\d{2}$/.test(input)) {\n          const [y, m, d] = input.split('-').map(n => parseInt(n, 10));\n          return new Date(y, m - 1, d);\n        }\n        const d = new Date(input);\n        return isNaN(d.getTime()) ? null : d;\n      } catch (e) {\n        return null;\n      }\n    },\n    formatTime(input) {\n      const d = new Date(input);\n      if (isNaN(d.getTime())) return '';\n      const hh = String(d.getHours()).padStart(2, '0');\n      const mm = String(d.getMinutes()).padStart(2, '0');\n      return `${hh}:${mm}`;\n    },\n    switchView(view) {\n      this.currentView = view;\n    },\n    previousPeriod() {\n      if (this.currentView === 'week') {\n        this.currentDate = new Date(this.currentDate.getTime() - 7 * 24 * 60 * 60 * 1000);\n      } else {\n        this.currentDate = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() - 1, 1);\n      }\n    },\n    nextPeriod() {\n      if (this.currentView === 'week') {\n        this.currentDate = new Date(this.currentDate.getTime() + 7 * 24 * 60 * 60 * 1000);\n      } else {\n        this.currentDate = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 1);\n      }\n    },\n    getStartOfWeek(date) {\n      const d = new Date(date);\n      const day = d.getDay();\n      const diff = d.getDate() - day + (day === 0 ? -6 : 1); // Adjust for Monday start\n      return new Date(d.setDate(diff));\n    },\n    formatDate(date) {\n      return `${date.getMonth() + 1}月${date.getDate()}日`;\n    },\n    formatDateText(date) {\n      const weekDayNames = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];\n      return `${date.getMonth() + 1}月${date.getDate()}日 ${weekDayNames[date.getDay()]}`;\n    },\n    isSelectedDate(date) {\n      return date.toDateString() === this.selectedDate.toDateString();\n    },\n    isCurrentMonth(date) {\n      return date.getMonth() === this.currentDate.getMonth();\n    },\n    selectDate(date) {\n      this.selectedDate = date;\n      if (this.currentView === 'week') {\n        this.currentDate = date;\n      }\n    },\n    getTaskCount(date) {\n      return this.tasks.filter(task => task && task.date && task.date.toDateString() === date.toDateString()).length;\n    },\n    getTasksForDate(date) {\n      return this.tasks.filter(task => task && task.date && task.date.toDateString() === date.toDateString());\n    },\n    async toggleTask(task) {\n      const prev = task.completed;\n      task.completed = !task.completed;\n      try {\n        await api.tasks.toggleTaskStatus(task.id);\n        // 成功后触发语音（完成播放鼓励，取消可选播放批评）\n        if (task.completed) {\n          playRandomVoice('encourage');\n        } else {\n          // 如需取消时播放批评，取消注释下一行\n          // playRandomVoice('criticize')\n        }\n      } catch (e) {\n        task.completed = prev;\n      }\n    },\n    openPomodoro(task) {\n      const query = {\n        task: task.title,\n        from: '/calendar'\n      };\n      if (task.id) query.taskId = task.id;\n      this.$router.push({\n        path: '/pomodoro',\n        query\n      });\n    },\n    openAddTask() {\n      // Navigate to AI Secretary for adding tasks\n      this.$router.push('/ai-secretary');\n    }\n  }\n};","map":{"version":3,"names":["CalendarCell","TaskItem","TabBar","api","playRandomVoice","name","components","data","currentView","selectedDate","Date","currentDate","weekDays","tasks","loading","error","created","fetchTasks","activated","computed","currentUserId","user","JSON","parse","localStorage","getItem","_id","id","periodLabel","startOfWeek","getStartOfWeek","endOfWeek","getTime","formatDate","getFullYear","getMonth","weekDates","dates","i","date","push","monthDates","startOfMonth","startDate","daySections","d","toDateString","title","dateText","formatDateText","getTasksForDate","watch","methods","userId","fetchTasksForDates","getMonthDays","err","console","dateObjs","uniqueDays","Array","from","Set","map","formatYmd","requests","dateStr","getAllTasks","then","res","catch","results","Promise","all","merged","seen","forEach","list","success","isArray","raw","normalizeTask","t","parseToLocalDate","key","has","add","idx","findIndex","x","anchor","y","m","daysInMonth","getDate","arr","String","padStart","day","completed","priority","timeDisplay","time","trim","startTime","endTime","formatTime","dateObj","createdAt","input","test","split","n","parseInt","isNaN","e","hh","getHours","mm","getMinutes","switchView","view","previousPeriod","nextPeriod","getDay","diff","setDate","weekDayNames","isSelectedDate","isCurrentMonth","selectDate","getTaskCount","filter","task","length","toggleTask","prev","toggleTaskStatus","openPomodoro","query","taskId","$router","path","openAddTask"],"sources":["C:\\Users\\wuby\\OneDrive\\Desktop\\已完成\\ai秘书\\backup\\timer\\src\\views\\Calendar.vue"],"sourcesContent":["<template>\n  <div class=\"calendar-container\">\n    <!-- Header -->\n    <div class=\"header\">\n      <div class=\"header-content\">\n        <div class=\"header-title\">日历中心</div>\n        <div class=\"view-toggle\">\n          <button \n            class=\"toggle-btn\" \n            :class=\"{ active: currentView === 'week' }\"\n            @click=\"switchView('week')\"\n          >\n            周视图\n          </button>\n          <button \n            class=\"toggle-btn\" \n            :class=\"{ active: currentView === 'month' }\"\n            @click=\"switchView('month')\"\n          >\n            月视图\n          </button>\n        </div>\n      </div>\n      \n      <!-- Week Navigation -->\n      <div class=\"week-nav\">\n        <button class=\"nav-btn\" @click=\"previousPeriod\">\n          <font-awesome-icon icon=\"chevron-left\" />\n        </button>\n        <div class=\"week-range\">{{ periodLabel }}</div>\n        <button class=\"nav-btn\" @click=\"nextPeriod\">\n          <font-awesome-icon icon=\"chevron-right\" />\n        </button>\n      </div>\n      \n      <!-- Week Dates -->\n      <div v-if=\"currentView === 'week'\" class=\"week-dates\">\n        <CalendarCell\n          v-for=\"date in weekDates\"\n          :key=\"date.getTime()\"\n          :date=\"date\"\n          :is-selected=\"isSelectedDate(date)\"\n          :task-count=\"getTaskCount(date)\"\n          :show-week-day=\"true\"\n          @select=\"selectDate\"\n        />\n      </div>\n    </div>\n    \n    <!-- Content -->\n    <div v-if=\"currentView === 'week'\" class=\"content\">\n      <div v-for=\"daySection in daySections\" :key=\"daySection.date\" class=\"day-section\">\n        <div class=\"day-header\">\n          <div class=\"day-title\">{{ daySection.title }}</div>\n          <div class=\"day-date\">{{ daySection.dateText }}</div>\n        </div>\n        \n        <div class=\"task-list\">\n          <TaskItem\n            v-for=\"task in daySection.tasks\"\n            :key=\"task.id\"\n            :task=\"task\"\n            @click=\"openPomodoro\"\n            @toggle=\"toggleTask\"\n          />\n        </div>\n      </div>\n    </div>\n    \n    <!-- Month View -->\n    <div v-else class=\"month-view\">\n      <div class=\"month-grid\">\n        <CalendarCell\n          v-for=\"date in monthDates\"\n          :key=\"date.getTime()\"\n          :date=\"date\"\n          :is-selected=\"isSelectedDate(date)\"\n          :is-other-month=\"!isCurrentMonth(date)\"\n          :task-count=\"getTaskCount(date)\"\n          @select=\"selectDate\"\n        />\n      </div>\n      <!-- Month Selected Day Content -->\n      <div class=\"month-content\">\n        <div v-for=\"daySection in daySections\" :key=\"daySection.date\" class=\"day-section\">\n          <div class=\"day-header\">\n            <div class=\"day-title\">{{ daySection.title }}</div>\n            <div class=\"day-date\">{{ daySection.dateText }}</div>\n          </div>\n          <div class=\"task-list\">\n            <TaskItem\n              v-for=\"task in daySection.tasks\"\n              :key=\"task.id\"\n              :task=\"task\"\n              @click=\"openPomodoro\"\n              @toggle=\"toggleTask\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Add Task Button -->\n    <button class=\"add-task-btn\" @click=\"openAddTask\">\n      <font-awesome-icon icon=\"plus\" />\n    </button>\n    \n    <!-- Tab Bar -->\n    <TabBar />\n  </div>\n</template>\n\n<script>\nimport CalendarCell from '../components/calendar/CalendarCell.vue'\nimport TaskItem from '../components/common/TaskItem.vue'\nimport TabBar from '../components/common/TabBar.vue'\nimport api from '../api'\nimport { playRandomVoice } from '@/aivoice/voicePlayer.js'\n\nexport default {\n  name: 'CalendarView',\n  components: {\n    CalendarCell,\n    TaskItem,\n    TabBar\n  },\n  data() {\n    return {\n      currentView: 'week',\n      selectedDate: new Date(),\n      currentDate: new Date(),\n      weekDays: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],\n      tasks: [],\n      loading: false,\n      error: null\n    }\n  },\n  created() {\n    this.fetchTasks()\n  },\n  activated() {\n    this.fetchTasks()\n  },\n  computed: {\n    currentUserId() {\n      const user = JSON.parse(localStorage.getItem('user') || 'null')\n      return user?._id || user?.id || null\n    },\n    periodLabel() {\n      if (this.currentView === 'week') {\n        const startOfWeek = this.getStartOfWeek(this.currentDate)\n        const endOfWeek = new Date(startOfWeek.getTime() + 6 * 24 * 60 * 60 * 1000)\n        return `${this.formatDate(startOfWeek)} - ${this.formatDate(endOfWeek)}`\n      } else {\n        return `${this.currentDate.getFullYear()}年${this.currentDate.getMonth() + 1}月`\n      }\n    },\n    weekDates() {\n      const startOfWeek = this.getStartOfWeek(this.currentDate)\n      const dates = []\n      for (let i = 0; i < 7; i++) {\n        const date = new Date(startOfWeek.getTime() + i * 24 * 60 * 60 * 1000)\n        dates.push(date)\n      }\n      return dates\n    },\n    monthDates() {\n      const startOfMonth = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), 1)\n  \n      \n      // Get start of week for first day of month\n      const startDate = this.getStartOfWeek(startOfMonth)\n      \n      // Get end date (6 weeks worth of days)\n      const dates = []\n      for (let i = 0; i < 42; i++) {\n        const date = new Date(startDate.getTime() + i * 24 * 60 * 60 * 1000)\n        dates.push(date)\n      }\n      return dates\n    },\n    daySections() {\n      const d = this.selectedDate\n      return [\n        {\n          date: d.toDateString(),\n          title: '所选日期',\n          dateText: this.formatDateText(d),\n          tasks: this.getTasksForDate(d)\n        }\n      ]\n    }\n  },\n  watch: {\n    currentView() {\n      this.fetchTasks()\n    },\n    currentDate() {\n      // 切换周/月的周期时刷新\n      this.fetchTasks()\n    },\n    selectedDate() {\n      if (this.currentView === 'week') {\n        // 同步周内切换日期也刷新一次，避免缓存陈旧\n        this.fetchTasks()\n      }\n    }\n  },\n  methods: {\n    async fetchTasks() {\n      this.loading = true\n      this.error = null\n      try {\n        const userId = this.currentUserId\n        if (!userId) {\n          this.error = '未登录，无法获取任务'\n          this.loading = false\n          return\n        }\n        // 优先按周期逐日拉取，保证日期精准映射\n        if (this.currentView === 'week') {\n          const dates = this.weekDates\n          this.tasks = await this.fetchTasksForDates(userId, dates)\n        } else {\n          const dates = this.getMonthDays(this.currentDate)\n          this.tasks = await this.fetchTasksForDates(userId, dates)\n        }\n      } catch (err) {\n        console.error('[Calendar] 获取任务失败', err)\n        this.error = '获取任务失败'\n      } finally {\n        this.loading = false\n      }\n    },\n    async fetchTasksForDates(userId, dateObjs) {\n      const uniqueDays = Array.from(new Set(dateObjs.map(d => this.formatYmd(d))))\n      const requests = uniqueDays.map(dateStr => api.tasks.getAllTasks({ userId, date: dateStr }).then(res => ({ res, dateStr })).catch(() => ({ res: null, dateStr })))\n      const results = await Promise.all(requests)\n      const merged = []\n      const seen = new Set()\n      results.forEach(({ res, dateStr }) => {\n        let list = []\n        if (res && res.success && Array.isArray(res.data)) list = res.data\n        else if (res && res.data && Array.isArray(res.data.data)) list = res.data.data\n        else if (Array.isArray(res)) list = res\n        list.map(raw => this.normalizeTask(raw)).forEach(t => {\n          if (!t) return\n          if (!t.date) t.date = this.parseToLocalDate(dateStr)\n          const key = `${t.id}`\n          if (!seen.has(key)) {\n            seen.add(key)\n            merged.push(t)\n          } else {\n            // 如果已存在但没有日期，补日期\n            const idx = merged.findIndex(x => `${x.id}` === key)\n            if (idx >= 0 && !merged[idx].date) merged[idx].date = this.parseToLocalDate(dateStr)\n          }\n        })\n      })\n      return merged\n    },\n    getMonthDays(anchor) {\n      const y = anchor.getFullYear()\n      const m = anchor.getMonth()\n      const daysInMonth = new Date(y, m + 1, 0).getDate()\n      const arr = []\n      for (let i = 1; i <= daysInMonth; i++) {\n        arr.push(new Date(y, m, i))\n      }\n      return arr\n    },\n    formatYmd(d) {\n      const y = d.getFullYear()\n      const m = String(d.getMonth() + 1).padStart(2, '0')\n      const day = String(d.getDate()).padStart(2, '0')\n      return `${y}-${m}-${day}`\n    },\n    normalizeTask(raw) {\n      if (!raw) return null\n      const id = raw._id || raw.id\n      const title = raw.title || raw.name || ''\n      const completed = !!raw.completed\n      const priority = raw.priority || 'medium'\n      // 处理时间显示：若有 time 则展示为 \"HH:MM - HH:MM+1h\"，否则为空\n      let timeDisplay = ''\n      if (typeof raw.time === 'string' && raw.time.trim()) {\n        timeDisplay = raw.time\n      } else if (raw.startTime && raw.endTime) {\n        // 兼容可能存在的开始/结束时间字段\n        timeDisplay = `${this.formatTime(raw.startTime)} - ${this.formatTime(raw.endTime)}`\n      }\n      // 处理日期：优先 raw.date，其次 raw.startTime，再次 raw.createdAt，否则丢弃（避免破坏日历统计）\n      let dateObj = null\n      if (raw.date) {\n        dateObj = this.parseToLocalDate(raw.date)\n      } else if (raw.startTime) {\n        dateObj = this.parseToLocalDate(raw.startTime)\n      } else if (raw.createdAt) {\n        dateObj = this.parseToLocalDate(raw.createdAt)\n      }\n      if (!id || !title) return null\n      return {\n        id,\n        title,\n        time: timeDisplay,\n        date: dateObj,\n        priority,\n        completed\n      }\n    },\n    parseToLocalDate(input) {\n      if (!input) return null\n      if (input instanceof Date) return input\n      // 处理 'YYYY-MM-DD' 或 ISO 字符串\n      try {\n        if (typeof input === 'string' && /^\\d{4}-\\d{2}-\\d{2}$/.test(input)) {\n          const [y, m, d] = input.split('-').map(n => parseInt(n, 10))\n          return new Date(y, m - 1, d)\n        }\n        const d = new Date(input)\n        return isNaN(d.getTime()) ? null : d\n      } catch (e) {\n        return null\n      }\n    },\n    formatTime(input) {\n      const d = new Date(input)\n      if (isNaN(d.getTime())) return ''\n      const hh = String(d.getHours()).padStart(2, '0')\n      const mm = String(d.getMinutes()).padStart(2, '0')\n      return `${hh}:${mm}`\n    },\n    switchView(view) {\n      this.currentView = view\n    },\n    previousPeriod() {\n      if (this.currentView === 'week') {\n        this.currentDate = new Date(this.currentDate.getTime() - 7 * 24 * 60 * 60 * 1000)\n      } else {\n        this.currentDate = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() - 1, 1)\n      }\n    },\n    nextPeriod() {\n      if (this.currentView === 'week') {\n        this.currentDate = new Date(this.currentDate.getTime() + 7 * 24 * 60 * 60 * 1000)\n      } else {\n        this.currentDate = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 1)\n      }\n    },\n    getStartOfWeek(date) {\n      const d = new Date(date)\n      const day = d.getDay()\n      const diff = d.getDate() - day + (day === 0 ? -6 : 1) // Adjust for Monday start\n      return new Date(d.setDate(diff))\n    },\n    formatDate(date) {\n      return `${date.getMonth() + 1}月${date.getDate()}日`\n    },\n    formatDateText(date) {\n      const weekDayNames = ['周日', '周一', '周二', '周三', '周四', '周五', '周六']\n      return `${date.getMonth() + 1}月${date.getDate()}日 ${weekDayNames[date.getDay()]}`\n    },\n    isSelectedDate(date) {\n      return date.toDateString() === this.selectedDate.toDateString()\n    },\n    isCurrentMonth(date) {\n      return date.getMonth() === this.currentDate.getMonth()\n    },\n    selectDate(date) {\n      this.selectedDate = date\n      if (this.currentView === 'week') {\n        this.currentDate = date\n      }\n    },\n    getTaskCount(date) {\n      return this.tasks.filter(task => task && task.date && task.date.toDateString() === date.toDateString()).length\n    },\n    getTasksForDate(date) {\n      return this.tasks.filter(task => task && task.date && task.date.toDateString() === date.toDateString())\n    },\n    async toggleTask(task) {\n      const prev = task.completed\n      task.completed = !task.completed\n      try {\n        await api.tasks.toggleTaskStatus(task.id)\n        // 成功后触发语音（完成播放鼓励，取消可选播放批评）\n        if (task.completed) {\n          playRandomVoice('encourage')\n        } else {\n          // 如需取消时播放批评，取消注释下一行\n          // playRandomVoice('criticize')\n        }\n      } catch (e) {\n        task.completed = prev\n      }\n    },\n    openPomodoro(task) {\n      const query = { task: task.title, from: '/calendar' }\n      if (task.id) query.taskId = task.id\n      this.$router.push({ path: '/pomodoro', query })\n    },\n    openAddTask() {\n      // Navigate to AI Secretary for adding tasks\n      this.$router.push('/ai-secretary')\n    }\n  }\n}\n</script>\n\n<style scoped>\n.calendar-container {\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  background: #f2f2f7;\n}\n\n.header {\n  background: #fff;\n  padding: 20px 30px;\n  border-bottom: 0.5px solid #e5e5ea;\n}\n\n.header-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 16px;\n  margin-bottom: 20px;\n}\n\n.header-title {\n  font-size: 28px;\n  font-weight: 700;\n  color: #1d1d1f;\n}\n\n.view-toggle {\n  display: flex;\n  gap: 8px;\n  background: #f2f2f7;\n  border-radius: 20px;\n  padding: 4px;\n}\n\n.toggle-btn {\n  padding: 8px 16px;\n  border: none;\n  background: transparent;\n  border-radius: 16px;\n  font-size: 14px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  color: #8e8e93;\n}\n\n.toggle-btn.active {\n  background: #007aff;\n  color: white;\n}\n\n.week-nav {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.nav-btn {\n  width: 40px;\n  height: 40px;\n  border-radius: 20px;\n  background: #f2f2f7;\n  border: none;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s;\n  color: #007aff;\n}\n\n.nav-btn:hover {\n  background: #e5e5ea;\n}\n\n.week-range {\n  font-size: 16px;\n  font-weight: 600;\n  color: #1d1d1f;\n}\n\n.week-dates {\n  display: grid;\n  grid-template-columns: repeat(7, 1fr);\n  gap: 8px;\n  text-align: center;\n}\n\n.content {\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px 30px 100px;\n}\n\n.day-section {\n  background: white;\n  border-radius: 16px;\n  padding: 20px;\n  margin-bottom: 20px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.day-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n  padding-bottom: 12px;\n  border-bottom: 1px solid #f2f2f7;\n}\n\n.day-title {\n  font-size: 18px;\n  font-weight: 600;\n  color: #1d1d1f;\n}\n\n.day-date {\n  font-size: 14px;\n  color: #8e8e93;\n}\n\n.task-list {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.month-view {\n  flex: 1;\n  padding: 20px 30px 100px;\n  overflow-y: auto;\n}\n\n.month-grid {\n  display: grid;\n  grid-template-columns: repeat(7, 1fr);\n  gap: 8px;\n  background: white;\n  border-radius: 16px;\n  padding: 20px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.month-content {\n  margin-top: 20px;\n}\n\n.add-task-btn {\n  position: fixed;\n  bottom: 100px;\n  right: 30px;\n  width: 56px;\n  height: 56px;\n  border-radius: 28px;\n  background: #007aff;\n  color: white;\n  border: none;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);\n  transition: all 0.2s;\n  z-index: 100;\n}\n\n.add-task-btn:hover {\n  transform: scale(1.1);\n  box-shadow: 0 6px 16px rgba(0, 122, 255, 0.4);\n}\n\n@media (max-width: 430px) {\n  .header {\n    padding: 16px 20px;\n  }\n  \n  .header-title {\n    font-size: 24px;\n  }\n  \n  .content {\n    padding: 16px 20px 100px;\n  }\n  \n  .month-view {\n    padding: 16px 20px 100px;\n    overflow-y: auto;\n  }\n  \n  .day-section {\n    padding: 16px;\n  }\n  \n  .week-nav {\n    padding: 0 10px;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}