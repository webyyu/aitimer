{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport speechRecognitionService from '../../AIsiri/services/speechRecognitionService.js';\nimport { log } from '../../AIsiri/utils/logger.js';\nimport ImageAnalysisModal from './ImageAnalysisModal.vue';\nexport default {\n  name: 'MessageInput',\n  components: {\n    ImageAnalysisModal\n  },\n  data() {\n    return {\n      inputText: '',\n      isListening: false,\n      isProcessing: false,\n      recognitionResult: null,\n      recognitionStatusText: 'Ê≠£Âú®ËØÜÂà´‰∏≠...',\n      selectedFile: null,\n      showImageAnalysisModal: false,\n      // Êñ∞Â¢ûÂΩïÈü≥Áõ∏ÂÖ≥Áä∂ÊÄÅ\n      mediaRecorder: null,\n      audioChunks: [],\n      recordingTime: 0,\n      recordingTimer: null,\n      stream: null\n    };\n  },\n  methods: {\n    /**\n     * ÂèëÈÄÅÊñáÊú¨Ê∂àÊÅØ\n     */\n    sendMessage() {\n      if (!this.inputText.trim() || this.isProcessing) return;\n      log.user('ÂèëÈÄÅÊñáÊú¨Ê∂àÊÅØ', {\n        message: this.inputText\n      });\n      this.$emit('sendMessage', this.inputText);\n      this.inputText = '';\n    },\n    /**\n     * ÂàáÊç¢ËØ≠Èü≥ËæìÂÖ•Ê®°Âºè\n     */\n    async toggleVoiceInput() {\n      if (this.isProcessing) return;\n      if (this.isListening) {\n        this.stopVoiceInput();\n      } else {\n        await this.startVoiceInput();\n      }\n    },\n    /**\n     * ÂºÄÂßãËØ≠Èü≥ËæìÂÖ•ÔºàÂÆûÊó∂ÂΩïÈü≥Ôºâ\n     */\n    async startVoiceInput() {\n      try {\n        log.info('ÂºÄÂßãÂÆûÊó∂ÂΩïÈü≥');\n\n        // ËØ∑Ê±ÇÈ∫¶ÂÖãÈ£éÊùÉÈôê\n        this.stream = await navigator.mediaDevices.getUserMedia({\n          audio: {\n            echoCancellation: true,\n            noiseSuppression: true,\n            sampleRate: 44100\n          }\n        });\n\n        // ÂàõÂª∫MediaRecorder - ‰ΩøÁî®ÂêéÁ´ØÊîØÊåÅÁöÑÊ†ºÂºè\n        let mimeType = 'audio/wav';\n\n        // Ê£ÄÊü•ÊµèËßàÂô®ÊîØÊåÅÁöÑÊ†ºÂºèÔºå‰ºòÂÖà‰ΩøÁî®ÂêéÁ´ØÊîØÊåÅÁöÑÊ†ºÂºè\n        if (MediaRecorder.isTypeSupported('audio/wav')) {\n          mimeType = 'audio/wav';\n        } else if (MediaRecorder.isTypeSupported('audio/mp4')) {\n          mimeType = 'audio/mp4';\n        } else if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {\n          mimeType = 'audio/webm;codecs=opus';\n        } else if (MediaRecorder.isTypeSupported('audio/webm')) {\n          mimeType = 'audio/webm';\n        }\n        this.mediaRecorder = new MediaRecorder(this.stream, {\n          mimeType: mimeType\n        });\n\n        // ÈáçÁΩÆÂΩïÈü≥Áä∂ÊÄÅ\n        this.audioChunks = [];\n        this.recordingTime = 0;\n\n        // ÂºÄÂßãÂΩïÈü≥\n        this.mediaRecorder.start();\n        this.isListening = true;\n\n        // ÂºÄÂßãËÆ°Êó∂\n        this.startRecordingTimer();\n\n        // ÁõëÂê¨ÂΩïÈü≥Êï∞ÊçÆ\n        this.mediaRecorder.ondataavailable = event => {\n          if (event.data.size > 0) {\n            this.audioChunks.push(event.data);\n          }\n        };\n\n        // ÂΩïÈü≥ÁªìÊùüÂ§ÑÁêÜ\n        this.mediaRecorder.onstop = () => {\n          this.handleRecordingComplete();\n        };\n        log.success('ÂÆûÊó∂ÂΩïÈü≥ÂºÄÂßã');\n      } catch (error) {\n        log.error('ÂêØÂä®ÂΩïÈü≥Â§±Ë¥•', error);\n        this.showToast('Êó†Ê≥ïËÆøÈóÆÈ∫¶ÂÖãÈ£éÔºåËØ∑Ê£ÄÊü•ÊùÉÈôêËÆæÁΩÆ', 'error');\n\n        // Â¶ÇÊûúÂÆûÊó∂ÂΩïÈü≥Â§±Ë¥•ÔºåÂõûÈÄÄÂà∞Êñá‰ª∂ÈÄâÊã©Ê®°Âºè\n        this.fallbackToFileInput();\n      }\n    },\n    /**\n     * ÂÅúÊ≠¢ËØ≠Èü≥ËæìÂÖ•\n     */\n    stopVoiceInput() {\n      if (this.mediaRecorder && this.isListening) {\n        log.info('ÂÅúÊ≠¢ÂÆûÊó∂ÂΩïÈü≥');\n        this.mediaRecorder.stop();\n        this.isListening = false;\n        this.stopRecordingTimer();\n\n        // ÂÅúÊ≠¢È∫¶ÂÖãÈ£éÊµÅ\n        if (this.stream) {\n          this.stream.getTracks().forEach(track => track.stop());\n          this.stream = null;\n        }\n      }\n    },\n    /**\n     * ÂºÄÂßãÂΩïÈü≥ËÆ°Êó∂Âô®\n     */\n    startRecordingTimer() {\n      this.recordingTimer = setInterval(() => {\n        this.recordingTime++;\n      }, 1000);\n    },\n    /**\n     * ÂÅúÊ≠¢ÂΩïÈü≥ËÆ°Êó∂Âô®\n     */\n    stopRecordingTimer() {\n      if (this.recordingTimer) {\n        clearInterval(this.recordingTimer);\n        this.recordingTimer = null;\n      }\n    },\n    /**\n     * Ê†ºÂºèÂåñÂΩïÈü≥Êó∂Èó¥\n     */\n    formatRecordingTime(seconds) {\n      const mins = Math.floor(seconds / 60);\n      const secs = seconds % 60;\n      return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n    },\n    /**\n     * Â§ÑÁêÜÂΩïÈü≥ÂÆåÊàê\n     */\n    async handleRecordingComplete() {\n      try {\n        if (this.audioChunks.length === 0) {\n          this.showToast('ÂΩïÈü≥Â§±Ë¥•ÔºåÊ≤°ÊúâÂΩïÂà∂Âà∞Èü≥È¢ë', 'error');\n          return;\n        }\n\n        // ÂàõÂª∫Èü≥È¢ëBlob\n        const audioBlob = new Blob(this.audioChunks, {\n          type: this.mediaRecorder.mimeType\n        });\n\n        // Ê†πÊçÆMIMEÁ±ªÂûãÁ°ÆÂÆöÊñá‰ª∂Êâ©Â±ïÂêç\n        let fileExtension = 'wav';\n        if (this.mediaRecorder.mimeType.includes('mp4')) {\n          fileExtension = 'm4a';\n        } else if (this.mediaRecorder.mimeType.includes('webm')) {\n          fileExtension = 'webm';\n        }\n\n        // ÂàõÂª∫FileÂØπË±°\n        const audioFile = new File([audioBlob], `recording_${Date.now()}.${fileExtension}`, {\n          type: this.mediaRecorder.mimeType\n        });\n        log.info('ÂΩïÈü≥ÂÆåÊàêÔºåÂºÄÂßãÂ§ÑÁêÜ', {\n          fileName: audioFile.name,\n          fileSize: audioFile.size,\n          duration: this.recordingTime\n        });\n\n        // ÂºÄÂßãËØ≠Èü≥ËØÜÂà´\n        await this.processAudioFile(audioFile);\n      } catch (error) {\n        log.error('Â§ÑÁêÜÂΩïÈü≥Â§±Ë¥•', error);\n        this.showToast(`Â§ÑÁêÜÂΩïÈü≥Â§±Ë¥•: ${error.message}`, 'error');\n      } finally {\n        // Ê∏ÖÁêÜÁä∂ÊÄÅ\n        this.audioChunks = [];\n        this.recordingTime = 0;\n        this.mediaRecorder = null;\n      }\n    },\n    /**\n     * Â§ÑÁêÜÈü≥È¢ëÊñá‰ª∂ÔºàÂΩïÈü≥Êàñ‰∏ä‰º†Ôºâ\n     */\n    async processAudioFile(audioFile) {\n      try {\n        this.isProcessing = true;\n        this.recognitionStatusText = 'Ê≠£Âú®‰∏ä‰º†Èü≥È¢ëÊñá‰ª∂...';\n        log.info('ÂºÄÂßãËØ≠Èü≥ËØÜÂà´', {\n          fileName: audioFile.name,\n          fileSize: audioFile.size\n        });\n\n        // È™åËØÅÊñá‰ª∂\n        const validation = speechRecognitionService.validateAudioFile(audioFile);\n        if (!validation.isValid) {\n          throw new Error(validation.errors.join(', '));\n        }\n\n        // ÂºÄÂßãËØ≠Èü≥ËØÜÂà´\n        this.recognitionStatusText = 'Ê≠£Âú®ËØÜÂà´‰∏≠ÔºåËØ∑Á®çÂÄô...';\n        const result = await speechRecognitionService.recognizeVoice(audioFile);\n        if (result.success) {\n          this.recognitionResult = result;\n          this.recognitionStatusText = 'ËØÜÂà´ÂÆåÊàê';\n          log.success('ËØ≠Èü≥ËØÜÂà´ÊàêÂäü', {\n            transcription: result.transcription\n          });\n\n          // Ëá™Âä®Â°´ÂÖÖÂà∞ËæìÂÖ•Ê°Ü\n          this.inputText = result.transcription;\n\n          // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫\n          this.showToast('ËØ≠Èü≥ËØÜÂà´ÊàêÂäüÔºÅ', 'success');\n        } else {\n          throw new Error('ËØÜÂà´Â§±Ë¥•');\n        }\n      } catch (error) {\n        log.error('ËØ≠Èü≥ËØÜÂà´Â§±Ë¥•', error);\n        this.recognitionStatusText = 'ËØÜÂà´Â§±Ë¥•';\n        this.showToast(`ËØ≠Èü≥ËØÜÂà´Â§±Ë¥•: ${error.message}`, 'error');\n      } finally {\n        this.isProcessing = false;\n        this.isListening = false;\n        this.selectedFile = null;\n\n        // Ê∏ÖÁ©∫Êñá‰ª∂ËæìÂÖ•\n        if (this.$refs.fileInput) {\n          this.$refs.fileInput.value = '';\n        }\n      }\n    },\n    /**\n     * ÂõûÈÄÄÂà∞Êñá‰ª∂ÈÄâÊã©Ê®°Âºè\n     */\n    fallbackToFileInput() {\n      log.info('ÂõûÈÄÄÂà∞Êñá‰ª∂ÈÄâÊã©Ê®°Âºè');\n      this.$refs.fileInput.click();\n    },\n    /**\n     * Â§ÑÁêÜÊñá‰ª∂ÈÄâÊã©ÔºàÂ§áÁî®ÊñπÊ°àÔºâ\n     */\n    async handleFileSelect(event) {\n      const file = event.target.files[0];\n      if (!file) {\n        this.stopVoiceInput();\n        return;\n      }\n      try {\n        this.selectedFile = file;\n        await this.processAudioFile(file);\n      } catch (error) {\n        log.error('Êñá‰ª∂Â§ÑÁêÜÂ§±Ë¥•', error);\n        this.showToast(`Êñá‰ª∂Â§ÑÁêÜÂ§±Ë¥•: ${error.message}`, 'error');\n      }\n    },\n    /**\n     * ÁºñËæëËØÜÂà´ÁªìÊûú\n     */\n    editRecognitionResult() {\n      if (this.recognitionResult) {\n        this.inputText = this.recognitionResult.transcription;\n        this.clearRecognitionResult();\n        // ËÅöÁÑ¶Âà∞ËæìÂÖ•Ê°Ü\n        this.$nextTick(() => {\n          const input = this.$el.querySelector('.message-input');\n          if (input) input.focus();\n        });\n      }\n    },\n    /**\n     * ÂèëÈÄÅËØÜÂà´ÁªìÊûú\n     */\n    sendRecognitionResult() {\n      if (this.recognitionResult) {\n        this.inputText = this.recognitionResult.transcription;\n        this.sendMessage();\n        this.clearRecognitionResult();\n      }\n    },\n    /**\n     * Ê∏ÖÈô§ËØÜÂà´ÁªìÊûú\n     */\n    clearRecognitionResult() {\n      this.recognitionResult = null;\n    },\n    /**\n     * Ëé∑ÂèñËØ≠Èü≥ÊåâÈíÆÂõæÊ†á\n     */\n    getVoiceButtonIcon() {\n      if (this.isProcessing) {\n        return 'spinner';\n      } else if (this.isListening) {\n        return 'microphone-slash';\n      } else {\n        return 'microphone';\n      }\n    },\n    /**\n     * Ëé∑ÂèñËØ≠Èü≥ÊåâÈíÆÊ†áÈ¢ò\n     */\n    getVoiceButtonTitle() {\n      if (this.isProcessing) {\n        return 'Ê≠£Âú®ËØÜÂà´‰∏≠...';\n      } else if (this.isListening) {\n        return 'ÁÇπÂáªÂÅúÊ≠¢ÂΩïÈü≥';\n      } else {\n        return 'ÁÇπÂáªÂºÄÂßãËØ≠Èü≥ËæìÂÖ•';\n      }\n    },\n    /**\n     * ÊòæÁ§∫ÊèêÁ§∫‰ø°ÊÅØ\n     */\n    showToast(message, type = 'info') {\n      // ‰ΩøÁî®ÂÖ®Â±ÄtoastÊàñconsole\n      if (this.$toast) {\n        this.$toast[type]?.(message) || this.$toast(message);\n      } else {\n        console.log(`[${type.toUpperCase()}] ${message}`);\n      }\n    },\n    /**\n     * ÊâìÂºÄÂõæÁâáÂàÜÊûêÊ®°ÊÄÅÊ°Ü\n     */\n    openImageAnalysis() {\n      this.showImageAnalysisModal = true;\n      log.info('ÊâìÂºÄÂõæÁâáÂàÜÊûêÊ®°ÊÄÅÊ°Ü');\n    },\n    /**\n     * ÂÖ≥Èó≠ÂõæÁâáÂàÜÊûêÊ®°ÊÄÅÊ°Ü\n     */\n    closeImageAnalysisModal() {\n      this.showImageAnalysisModal = false;\n      log.info('ÂÖ≥Èó≠ÂõæÁâáÂàÜÊûêÊ®°ÊÄÅÊ°Ü');\n    },\n    /**\n     * Â§ÑÁêÜÂõæÁâáÂàÜÊûêÂÆåÊàê\n     */\n    handleImageAnalysisComplete(result) {\n      log.info('ÂõæÁâáÂàÜÊûêÂÆåÊàê', result);\n\n      // Â∞ÜÂàÜÊûêÁªìÊûú‰Ωú‰∏∫Ê∂àÊÅØÂèëÈÄÅ\n      const analysisMessage = `üñºÔ∏è ÂõæÁâáÂàÜÊûêÁªìÊûúÔºö\\n\\n${result.analysis.content}`;\n      this.$emit('sendMessage', analysisMessage);\n\n      // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü\n      this.closeImageAnalysisModal();\n\n      // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫\n      this.showToast('ÂõæÁâáÂàÜÊûêÂÆåÊàêÔºåÂ∑≤ÂèëÈÄÅÁªìÊûúÔºÅ', 'success');\n    }\n  },\n  beforeUnmount() {\n    // Ê∏ÖÁêÜËµÑÊ∫ê\n    if (this.isProcessing) {\n      speechRecognitionService.resetProcessingStatus();\n    }\n    // ÂÅúÊ≠¢ÂΩïÈü≥ÊµÅ\n    if (this.stream) {\n      this.stream.getTracks().forEach(track => track.stop());\n    }\n    // ÂÅúÊ≠¢ËÆ°Êó∂Âô®\n    this.stopRecordingTimer();\n  }\n};","map":{"version":3,"names":["speechRecognitionService","log","ImageAnalysisModal","name","components","data","inputText","isListening","isProcessing","recognitionResult","recognitionStatusText","selectedFile","showImageAnalysisModal","mediaRecorder","audioChunks","recordingTime","recordingTimer","stream","methods","sendMessage","trim","user","message","$emit","toggleVoiceInput","stopVoiceInput","startVoiceInput","info","navigator","mediaDevices","getUserMedia","audio","echoCancellation","noiseSuppression","sampleRate","mimeType","MediaRecorder","isTypeSupported","start","startRecordingTimer","ondataavailable","event","size","push","onstop","handleRecordingComplete","success","error","showToast","fallbackToFileInput","stop","stopRecordingTimer","getTracks","forEach","track","setInterval","clearInterval","formatRecordingTime","seconds","mins","Math","floor","secs","toString","padStart","length","audioBlob","Blob","type","fileExtension","includes","audioFile","File","Date","now","fileName","fileSize","duration","processAudioFile","validation","validateAudioFile","isValid","Error","errors","join","result","recognizeVoice","transcription","$refs","fileInput","value","click","handleFileSelect","file","target","files","editRecognitionResult","clearRecognitionResult","$nextTick","input","$el","querySelector","focus","sendRecognitionResult","getVoiceButtonIcon","getVoiceButtonTitle","$toast","console","toUpperCase","openImageAnalysis","closeImageAnalysisModal","handleImageAnalysisComplete","analysisMessage","analysis","content","beforeUnmount","resetProcessingStatus"],"sources":["C:\\Users\\wuby\\OneDrive\\Desktop\\backend(1) 3\\timer\\src\\components\\AIsecretary\\MessageInput.vue"],"sourcesContent":["<template>\n  <div class=\"input-area\">\n    <div class=\"input-container\">\n      <!-- ËØ≠Èü≥ËæìÂÖ•ÊåâÈíÆ -->\n      <button \n        class=\"voice-btn\" \n        @click=\"toggleVoiceInput\"\n        :class=\"{ 'listening': isListening, 'processing': isProcessing }\"\n        :disabled=\"isProcessing\"\n        :title=\"getVoiceButtonTitle()\"\n      >\n        <font-awesome-icon \n          :icon=\"getVoiceButtonIcon()\" \n          :class=\"{ 'pulse': isProcessing }\"\n        />\n      </button>\n\n      <!-- ÈöêËóèÁöÑÊñá‰ª∂ËæìÂÖ•Ôºà‰øùÁïô‰Ωú‰∏∫Â§áÁî®Ôºâ -->\n      <input \n        ref=\"fileInput\"\n        type=\"file\" \n        accept=\"audio/*\"\n        style=\"display: none\"\n        @change=\"handleFileSelect\"\n      >\n\n      <!-- ÊñáÊú¨ËæìÂÖ•Ê°Ü -->\n      <input \n        v-model=\"inputText\"\n        type=\"text\" \n        placeholder=\"ËæìÂÖ•‰Ω†ÁöÑÂ≠¶‰π†ÁõÆÊ†áÊàñÈóÆÈ¢ò...\"\n        class=\"message-input\"\n        @keypress.enter=\"sendMessage\"\n        :disabled=\"isProcessing\"\n      >\n\n      <!-- ÂèëÈÄÅÊåâÈíÆ -->\n      <button \n        class=\"send-btn\"\n        @click=\"sendMessage\"\n        :disabled=\"!inputText.trim() || isProcessing\"\n      >\n        <font-awesome-icon icon=\"paper-plane\" />\n      </button>\n\n      <!-- ÂõæÁâáÂàÜÊûêÊåâÈíÆ -->\n      <button \n        class=\"image-analysis-btn\"\n        @click=\"openImageAnalysis\"\n        :disabled=\"isProcessing\"\n        title=\"ÂõæÁâáÂàÜÊûê\"\n      >\n        <font-awesome-icon icon=\"image\" />\n      </button>\n    </div>\n\n    <!-- ÂΩïÈü≥Áä∂ÊÄÅÊèêÁ§∫ -->\n    <div v-if=\"isListening && !isProcessing\" class=\"recording-status\">\n      <div class=\"status-content\">\n        <font-awesome-icon icon=\"microphone\" class=\"recording-icon\" />\n        <span>Ê≠£Âú®ÂΩïÈü≥‰∏≠... ÁÇπÂáªÂÅúÊ≠¢</span>\n        <div class=\"recording-time\">{{ formatRecordingTime(recordingTime) }}</div>\n      </div>\n    </div>\n\n    <!-- ËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅÊèêÁ§∫ -->\n    <div v-if=\"isProcessing\" class=\"recognition-status\">\n      <div class=\"status-content\">\n        <font-awesome-icon icon=\"spinner\" spin />\n        <span>{{ recognitionStatusText }}</span>\n      </div>\n    </div>\n\n    <!-- ËØ≠Èü≥ËØÜÂà´ÁªìÊûúÈ¢ÑËßà -->\n    <div v-if=\"recognitionResult && !isProcessing\" class=\"recognition-preview\">\n      <div class=\"preview-header\">\n        <font-awesome-icon icon=\"microphone\" />\n        <span>ËØ≠Èü≥ËØÜÂà´ÁªìÊûú</span>\n        <button class=\"preview-close\" @click=\"clearRecognitionResult\">\n          <font-awesome-icon icon=\"times\" />\n        </button>\n      </div>\n      <div class=\"preview-content\">\n        <p class=\"preview-text\">{{ recognitionResult.transcription }}</p>\n        <div class=\"preview-actions\">\n          <button class=\"preview-btn preview-btn-edit\" @click=\"editRecognitionResult\">\n            <font-awesome-icon icon=\"edit\" />\n            ÁºñËæë\n          </button>\n          <button class=\"preview-btn preview-btn-send\" @click=\"sendRecognitionResult\">\n            <font-awesome-icon icon=\"paper-plane\" />\n            ÂèëÈÄÅ\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- ÂõæÁâáÂàÜÊûêÊ®°ÊÄÅÊ°Ü -->\n    <ImageAnalysisModal\n      :visible=\"showImageAnalysisModal\"\n      @close=\"closeImageAnalysisModal\"\n      @analysisComplete=\"handleImageAnalysisComplete\"\n      @showToast=\"showToast\"\n    />\n  </div>\n</template>\n\n<script>\nimport speechRecognitionService from '../../AIsiri/services/speechRecognitionService.js'\nimport { log } from '../../AIsiri/utils/logger.js'\nimport ImageAnalysisModal from './ImageAnalysisModal.vue'\n\nexport default {\n  name: 'MessageInput',\n  components: {\n    ImageAnalysisModal\n  },\n  data() {\n    return {\n      inputText: '',\n      isListening: false,\n      isProcessing: false,\n      recognitionResult: null,\n      recognitionStatusText: 'Ê≠£Âú®ËØÜÂà´‰∏≠...',\n      selectedFile: null,\n      showImageAnalysisModal: false,\n      // Êñ∞Â¢ûÂΩïÈü≥Áõ∏ÂÖ≥Áä∂ÊÄÅ\n      mediaRecorder: null,\n      audioChunks: [],\n      recordingTime: 0,\n      recordingTimer: null,\n      stream: null\n    }\n  },\n  methods: {\n    /**\n     * ÂèëÈÄÅÊñáÊú¨Ê∂àÊÅØ\n     */\n    sendMessage() {\n      if (!this.inputText.trim() || this.isProcessing) return;\n      \n      log.user('ÂèëÈÄÅÊñáÊú¨Ê∂àÊÅØ', { message: this.inputText })\n      this.$emit('sendMessage', this.inputText);\n      this.inputText = '';\n    },\n\n    /**\n     * ÂàáÊç¢ËØ≠Èü≥ËæìÂÖ•Ê®°Âºè\n     */\n    async toggleVoiceInput() {\n      if (this.isProcessing) return;\n      \n      if (this.isListening) {\n        this.stopVoiceInput();\n      } else {\n        await this.startVoiceInput();\n      }\n    },\n\n    /**\n     * ÂºÄÂßãËØ≠Èü≥ËæìÂÖ•ÔºàÂÆûÊó∂ÂΩïÈü≥Ôºâ\n     */\n    async startVoiceInput() {\n      try {\n        log.info('ÂºÄÂßãÂÆûÊó∂ÂΩïÈü≥')\n        \n        // ËØ∑Ê±ÇÈ∫¶ÂÖãÈ£éÊùÉÈôê\n        this.stream = await navigator.mediaDevices.getUserMedia({ \n          audio: {\n            echoCancellation: true,\n            noiseSuppression: true,\n            sampleRate: 44100\n          } \n        });\n        \n        // ÂàõÂª∫MediaRecorder - ‰ΩøÁî®ÂêéÁ´ØÊîØÊåÅÁöÑÊ†ºÂºè\n        let mimeType = 'audio/wav';\n        \n        // Ê£ÄÊü•ÊµèËßàÂô®ÊîØÊåÅÁöÑÊ†ºÂºèÔºå‰ºòÂÖà‰ΩøÁî®ÂêéÁ´ØÊîØÊåÅÁöÑÊ†ºÂºè\n        if (MediaRecorder.isTypeSupported('audio/wav')) {\n          mimeType = 'audio/wav';\n        } else if (MediaRecorder.isTypeSupported('audio/mp4')) {\n          mimeType = 'audio/mp4';\n        } else if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {\n          mimeType = 'audio/webm;codecs=opus';\n        } else if (MediaRecorder.isTypeSupported('audio/webm')) {\n          mimeType = 'audio/webm';\n        }\n        \n        this.mediaRecorder = new MediaRecorder(this.stream, {\n          mimeType: mimeType\n        });\n        \n        // ÈáçÁΩÆÂΩïÈü≥Áä∂ÊÄÅ\n        this.audioChunks = [];\n        this.recordingTime = 0;\n        \n        // ÂºÄÂßãÂΩïÈü≥\n        this.mediaRecorder.start();\n        this.isListening = true;\n        \n        // ÂºÄÂßãËÆ°Êó∂\n        this.startRecordingTimer();\n        \n        // ÁõëÂê¨ÂΩïÈü≥Êï∞ÊçÆ\n        this.mediaRecorder.ondataavailable = (event) => {\n          if (event.data.size > 0) {\n            this.audioChunks.push(event.data);\n          }\n        };\n        \n        // ÂΩïÈü≥ÁªìÊùüÂ§ÑÁêÜ\n        this.mediaRecorder.onstop = () => {\n          this.handleRecordingComplete();\n        };\n        \n        log.success('ÂÆûÊó∂ÂΩïÈü≥ÂºÄÂßã')\n        \n      } catch (error) {\n        log.error('ÂêØÂä®ÂΩïÈü≥Â§±Ë¥•', error);\n        this.showToast('Êó†Ê≥ïËÆøÈóÆÈ∫¶ÂÖãÈ£éÔºåËØ∑Ê£ÄÊü•ÊùÉÈôêËÆæÁΩÆ', 'error');\n        \n        // Â¶ÇÊûúÂÆûÊó∂ÂΩïÈü≥Â§±Ë¥•ÔºåÂõûÈÄÄÂà∞Êñá‰ª∂ÈÄâÊã©Ê®°Âºè\n        this.fallbackToFileInput();\n      }\n    },\n\n    /**\n     * ÂÅúÊ≠¢ËØ≠Èü≥ËæìÂÖ•\n     */\n    stopVoiceInput() {\n      if (this.mediaRecorder && this.isListening) {\n        log.info('ÂÅúÊ≠¢ÂÆûÊó∂ÂΩïÈü≥')\n        this.mediaRecorder.stop();\n        this.isListening = false;\n        this.stopRecordingTimer();\n        \n        // ÂÅúÊ≠¢È∫¶ÂÖãÈ£éÊµÅ\n        if (this.stream) {\n          this.stream.getTracks().forEach(track => track.stop());\n          this.stream = null;\n        }\n      }\n    },\n\n    /**\n     * ÂºÄÂßãÂΩïÈü≥ËÆ°Êó∂Âô®\n     */\n    startRecordingTimer() {\n      this.recordingTimer = setInterval(() => {\n        this.recordingTime++;\n      }, 1000);\n    },\n\n    /**\n     * ÂÅúÊ≠¢ÂΩïÈü≥ËÆ°Êó∂Âô®\n     */\n    stopRecordingTimer() {\n      if (this.recordingTimer) {\n        clearInterval(this.recordingTimer);\n        this.recordingTimer = null;\n      }\n    },\n\n    /**\n     * Ê†ºÂºèÂåñÂΩïÈü≥Êó∂Èó¥\n     */\n    formatRecordingTime(seconds) {\n      const mins = Math.floor(seconds / 60);\n      const secs = seconds % 60;\n      return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n    },\n\n    /**\n     * Â§ÑÁêÜÂΩïÈü≥ÂÆåÊàê\n     */\n    async handleRecordingComplete() {\n      try {\n        if (this.audioChunks.length === 0) {\n          this.showToast('ÂΩïÈü≥Â§±Ë¥•ÔºåÊ≤°ÊúâÂΩïÂà∂Âà∞Èü≥È¢ë', 'error');\n          return;\n        }\n\n        // ÂàõÂª∫Èü≥È¢ëBlob\n        const audioBlob = new Blob(this.audioChunks, { type: this.mediaRecorder.mimeType });\n        \n        // Ê†πÊçÆMIMEÁ±ªÂûãÁ°ÆÂÆöÊñá‰ª∂Êâ©Â±ïÂêç\n        let fileExtension = 'wav';\n        if (this.mediaRecorder.mimeType.includes('mp4')) {\n          fileExtension = 'm4a';\n        } else if (this.mediaRecorder.mimeType.includes('webm')) {\n          fileExtension = 'webm';\n        }\n        \n        // ÂàõÂª∫FileÂØπË±°\n        const audioFile = new File([audioBlob], `recording_${Date.now()}.${fileExtension}`, {\n          type: this.mediaRecorder.mimeType\n        });\n\n        log.info('ÂΩïÈü≥ÂÆåÊàêÔºåÂºÄÂßãÂ§ÑÁêÜ', { \n          fileName: audioFile.name, \n          fileSize: audioFile.size,\n          duration: this.recordingTime \n        });\n\n        // ÂºÄÂßãËØ≠Èü≥ËØÜÂà´\n        await this.processAudioFile(audioFile);\n        \n      } catch (error) {\n        log.error('Â§ÑÁêÜÂΩïÈü≥Â§±Ë¥•', error);\n        this.showToast(`Â§ÑÁêÜÂΩïÈü≥Â§±Ë¥•: ${error.message}`, 'error');\n      } finally {\n        // Ê∏ÖÁêÜÁä∂ÊÄÅ\n        this.audioChunks = [];\n        this.recordingTime = 0;\n        this.mediaRecorder = null;\n      }\n    },\n\n    /**\n     * Â§ÑÁêÜÈü≥È¢ëÊñá‰ª∂ÔºàÂΩïÈü≥Êàñ‰∏ä‰º†Ôºâ\n     */\n    async processAudioFile(audioFile) {\n      try {\n        this.isProcessing = true;\n        this.recognitionStatusText = 'Ê≠£Âú®‰∏ä‰º†Èü≥È¢ëÊñá‰ª∂...';\n        \n        log.info('ÂºÄÂßãËØ≠Èü≥ËØÜÂà´', { fileName: audioFile.name, fileSize: audioFile.size });\n\n        // È™åËØÅÊñá‰ª∂\n        const validation = speechRecognitionService.validateAudioFile(audioFile);\n        if (!validation.isValid) {\n          throw new Error(validation.errors.join(', '));\n        }\n\n        // ÂºÄÂßãËØ≠Èü≥ËØÜÂà´\n        this.recognitionStatusText = 'Ê≠£Âú®ËØÜÂà´‰∏≠ÔºåËØ∑Á®çÂÄô...';\n        const result = await speechRecognitionService.recognizeVoice(audioFile);\n        \n        if (result.success) {\n          this.recognitionResult = result;\n          this.recognitionStatusText = 'ËØÜÂà´ÂÆåÊàê';\n          log.success('ËØ≠Èü≥ËØÜÂà´ÊàêÂäü', { transcription: result.transcription });\n          \n          // Ëá™Âä®Â°´ÂÖÖÂà∞ËæìÂÖ•Ê°Ü\n          this.inputText = result.transcription;\n          \n          // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫\n          this.showToast('ËØ≠Èü≥ËØÜÂà´ÊàêÂäüÔºÅ', 'success');\n        } else {\n          throw new Error('ËØÜÂà´Â§±Ë¥•');\n        }\n      } catch (error) {\n        log.error('ËØ≠Èü≥ËØÜÂà´Â§±Ë¥•', error);\n        this.recognitionStatusText = 'ËØÜÂà´Â§±Ë¥•';\n        this.showToast(`ËØ≠Èü≥ËØÜÂà´Â§±Ë¥•: ${error.message}`, 'error');\n      } finally {\n        this.isProcessing = false;\n        this.isListening = false;\n        this.selectedFile = null;\n        \n        // Ê∏ÖÁ©∫Êñá‰ª∂ËæìÂÖ•\n        if (this.$refs.fileInput) {\n          this.$refs.fileInput.value = '';\n        }\n      }\n    },\n\n    /**\n     * ÂõûÈÄÄÂà∞Êñá‰ª∂ÈÄâÊã©Ê®°Âºè\n     */\n    fallbackToFileInput() {\n      log.info('ÂõûÈÄÄÂà∞Êñá‰ª∂ÈÄâÊã©Ê®°Âºè')\n      this.$refs.fileInput.click();\n    },\n\n    /**\n     * Â§ÑÁêÜÊñá‰ª∂ÈÄâÊã©ÔºàÂ§áÁî®ÊñπÊ°àÔºâ\n     */\n    async handleFileSelect(event) {\n      const file = event.target.files[0];\n      if (!file) {\n        this.stopVoiceInput();\n        return;\n      }\n\n      try {\n        this.selectedFile = file;\n        await this.processAudioFile(file);\n      } catch (error) {\n        log.error('Êñá‰ª∂Â§ÑÁêÜÂ§±Ë¥•', error);\n        this.showToast(`Êñá‰ª∂Â§ÑÁêÜÂ§±Ë¥•: ${error.message}`, 'error');\n      }\n    },\n\n    /**\n     * ÁºñËæëËØÜÂà´ÁªìÊûú\n     */\n    editRecognitionResult() {\n      if (this.recognitionResult) {\n        this.inputText = this.recognitionResult.transcription;\n        this.clearRecognitionResult();\n        // ËÅöÁÑ¶Âà∞ËæìÂÖ•Ê°Ü\n        this.$nextTick(() => {\n          const input = this.$el.querySelector('.message-input');\n          if (input) input.focus();\n        });\n      }\n    },\n\n    /**\n     * ÂèëÈÄÅËØÜÂà´ÁªìÊûú\n     */\n    sendRecognitionResult() {\n      if (this.recognitionResult) {\n        this.inputText = this.recognitionResult.transcription;\n        this.sendMessage();\n        this.clearRecognitionResult();\n      }\n    },\n\n    /**\n     * Ê∏ÖÈô§ËØÜÂà´ÁªìÊûú\n     */\n    clearRecognitionResult() {\n      this.recognitionResult = null;\n    },\n\n    /**\n     * Ëé∑ÂèñËØ≠Èü≥ÊåâÈíÆÂõæÊ†á\n     */\n    getVoiceButtonIcon() {\n      if (this.isProcessing) {\n        return 'spinner';\n      } else if (this.isListening) {\n        return 'microphone-slash';\n      } else {\n        return 'microphone';\n      }\n    },\n\n    /**\n     * Ëé∑ÂèñËØ≠Èü≥ÊåâÈíÆÊ†áÈ¢ò\n     */\n    getVoiceButtonTitle() {\n      if (this.isProcessing) {\n        return 'Ê≠£Âú®ËØÜÂà´‰∏≠...';\n      } else if (this.isListening) {\n        return 'ÁÇπÂáªÂÅúÊ≠¢ÂΩïÈü≥';\n      } else {\n        return 'ÁÇπÂáªÂºÄÂßãËØ≠Èü≥ËæìÂÖ•';\n      }\n    },\n\n    /**\n     * ÊòæÁ§∫ÊèêÁ§∫‰ø°ÊÅØ\n     */\n    showToast(message, type = 'info') {\n      // ‰ΩøÁî®ÂÖ®Â±ÄtoastÊàñconsole\n      if (this.$toast) {\n        this.$toast[type]?.(message) || this.$toast(message);\n      } else {\n        console.log(`[${type.toUpperCase()}] ${message}`);\n      }\n    },\n\n    /**\n     * ÊâìÂºÄÂõæÁâáÂàÜÊûêÊ®°ÊÄÅÊ°Ü\n     */\n    openImageAnalysis() {\n      this.showImageAnalysisModal = true;\n      log.info('ÊâìÂºÄÂõæÁâáÂàÜÊûêÊ®°ÊÄÅÊ°Ü');\n    },\n\n    /**\n     * ÂÖ≥Èó≠ÂõæÁâáÂàÜÊûêÊ®°ÊÄÅÊ°Ü\n     */\n    closeImageAnalysisModal() {\n      this.showImageAnalysisModal = false;\n      log.info('ÂÖ≥Èó≠ÂõæÁâáÂàÜÊûêÊ®°ÊÄÅÊ°Ü');\n    },\n\n    /**\n     * Â§ÑÁêÜÂõæÁâáÂàÜÊûêÂÆåÊàê\n     */\n    handleImageAnalysisComplete(result) {\n      log.info('ÂõæÁâáÂàÜÊûêÂÆåÊàê', result);\n      \n      // Â∞ÜÂàÜÊûêÁªìÊûú‰Ωú‰∏∫Ê∂àÊÅØÂèëÈÄÅ\n      const analysisMessage = `üñºÔ∏è ÂõæÁâáÂàÜÊûêÁªìÊûúÔºö\\n\\n${result.analysis.content}`;\n      this.$emit('sendMessage', analysisMessage);\n      \n      // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü\n      this.closeImageAnalysisModal();\n      \n      // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫\n      this.showToast('ÂõæÁâáÂàÜÊûêÂÆåÊàêÔºåÂ∑≤ÂèëÈÄÅÁªìÊûúÔºÅ', 'success');\n    }\n  },\n\n  beforeUnmount() {\n    // Ê∏ÖÁêÜËµÑÊ∫ê\n    if (this.isProcessing) {\n      speechRecognitionService.resetProcessingStatus();\n    }\n    // ÂÅúÊ≠¢ÂΩïÈü≥ÊµÅ\n    if (this.stream) {\n      this.stream.getTracks().forEach(track => track.stop());\n    }\n    // ÂÅúÊ≠¢ËÆ°Êó∂Âô®\n    this.stopRecordingTimer();\n  }\n}\n</script>\n\n<style scoped>\n.input-area {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: rgba(255, 255, 255, 0.95);\n  backdrop-filter: blur(20px);\n  border-top: 1px solid rgba(255, 255, 255, 0.3);\n  padding: 8px 16px 8px;\n  z-index: 1000;\n}\n\n.input-container {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.voice-btn {\n  width: 40px;\n  height: 40px;\n  border-radius: 20px;\n  border: none;\n  background: #f2f2f7;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s;\n  color: #667eea;\n  position: relative;\n}\n\n.voice-btn:hover:not(:disabled) {\n  background: #e5e5ea;\n  transform: scale(1.05);\n}\n\n.voice-btn.listening {\n  background: #ff3b30;\n  color: white;\n  animation: pulse 1.5s infinite;\n}\n\n.voice-btn.processing {\n  background: #007aff;\n  color: white;\n  cursor: not-allowed;\n}\n\n.voice-btn:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.voice-btn .pulse {\n  animation: spin 1s linear infinite;\n}\n\n.message-input {\n  flex: 1;\n  border: none;\n  outline: none;\n  font-size: 16px;\n  padding: 12px;\n  background: transparent;\n  border-radius: 20px;\n  background: #f2f2f7;\n  transition: all 0.2s;\n}\n\n.message-input:focus {\n  background: #ffffff;\n  box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);\n}\n\n.message-input:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.message-input::placeholder {\n  color: #8e8e93;\n}\n\n.send-btn {\n  width: 40px;\n  height: 40px;\n  border-radius: 20px;\n  border: none;\n  background: #007aff;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.send-btn:disabled {\n  background: #e5e5ea;\n  color: #8e8e93;\n  cursor: not-allowed;\n}\n\n.send-btn:not(:disabled):hover {\n  background: #0056d3;\n  transform: scale(1.05);\n}\n\n/* ÂõæÁâáÂàÜÊûêÊåâÈíÆÊ†∑Âºè - Ê®°‰ªøÂæÆ‰ø°È£éÊ†º */\n.image-analysis-btn {\n  width: 40px;\n  height: 40px;\n  border-radius: 20px;\n  border: none;\n  background: #f2f2f7;\n  color: #8e8e93;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.image-analysis-btn:hover:not(:disabled) {\n  background: #e5e5ea;\n  color: #007aff;\n  transform: scale(1.05);\n}\n\n.image-analysis-btn:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.image-analysis-btn svg {\n  font-size: 16px;\n}\n\n/* ÂΩïÈü≥Áä∂ÊÄÅÊèêÁ§∫ */\n.recording-status {\n  position: absolute;\n  bottom: 100%;\n  left: 0;\n  right: 0;\n  background: rgba(255, 59, 48, 0.1);\n  border-top: 1px solid rgba(255, 59, 48, 0.2);\n  padding: 12px 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  backdrop-filter: blur(10px);\n  z-index: 1000;\n}\n\n.recording-status .status-content {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #ff3b30;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.recording-status .recording-icon {\n  font-size: 18px;\n  color: #ff3b30;\n  animation: pulse 1.5s infinite;\n}\n\n.recording-status .recording-time {\n  font-size: 14px;\n  color: #ff3b30;\n  font-weight: 600;\n  background: rgba(255, 59, 48, 0.1);\n  padding: 4px 8px;\n  border-radius: 12px;\n  min-width: 45px;\n  text-align: center;\n}\n\n/* ËØ≠Èü≥ËØÜÂà´Áä∂ÊÄÅÊèêÁ§∫ */\n.recognition-status {\n  position: absolute;\n  bottom: 100%;\n  left: 0;\n  right: 0;\n  background: rgba(0, 122, 255, 0.1);\n  border-top: 1px solid rgba(0, 122, 255, 0.2);\n  padding: 8px 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.status-content {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #007aff;\n  font-size: 14px;\n}\n\n.status-content svg {\n  font-size: 16px;\n}\n\n/* ËØ≠Èü≥ËØÜÂà´ÁªìÊûúÈ¢ÑËßà */\n.recognition-preview {\n  position: absolute;\n  bottom: 100%;\n  left: 0;\n  right: 0;\n  background: rgba(255, 255, 255, 0.98);\n  backdrop-filter: blur(20px);\n  border-top: 1px solid rgba(0, 122, 255, 0.2);\n  border-radius: 16px 16px 0 0;\n  margin: 0 8px;\n  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);\n  overflow: hidden;\n}\n\n.preview-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  background: rgba(0, 122, 255, 0.1);\n  border-bottom: 1px solid rgba(0, 122, 255, 0.1);\n  color: #007aff;\n  font-weight: 600;\n  font-size: 14px;\n}\n\n.preview-header svg {\n  font-size: 16px;\n}\n\n.preview-close {\n  margin-left: auto;\n  background: none;\n  border: none;\n  color: #007aff;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s;\n}\n\n.preview-close:hover {\n  background: rgba(0, 122, 255, 0.1);\n}\n\n.preview-content {\n  padding: 16px;\n}\n\n.preview-text {\n  margin: 0 0 16px 0;\n  font-size: 16px;\n  line-height: 1.5;\n  color: #333;\n  background: #f8f9fa;\n  padding: 12px;\n  border-radius: 8px;\n  border-left: 4px solid #007aff;\n}\n\n.preview-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.preview-btn {\n  flex: 1;\n  padding: 10px 16px;\n  border: none;\n  border-radius: 8px;\n  font-size: 14px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n}\n\n.preview-btn-edit {\n  background: #f2f2f7;\n  color: #666;\n}\n\n.preview-btn-edit:hover {\n  background: #e5e5ea;\n}\n\n.preview-btn-send {\n  background: #007aff;\n  color: white;\n}\n\n.preview-btn-send:hover {\n  background: #0056d3;\n}\n\n/* Âä®Áîª */\n@keyframes pulse {\n  0%, 100% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(1.1);\n  }\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* ÂìçÂ∫îÂºèËÆæËÆ° */\n@media (max-width: 430px) {\n  .input-area {\n    padding: 8px 12px 8px;\n  }\n  \n  .voice-btn,\n  .send-btn {\n    width: 36px;\n    height: 36px;\n  }\n  \n  .message-input {\n    font-size: 15px;\n    padding: 10px;\n  }\n  \n  .preview-content {\n    padding: 12px;\n  }\n  \n  .preview-text {\n    font-size: 15px;\n    padding: 10px;\n  }\n  \n  .preview-btn {\n    padding: 8px 12px;\n    font-size: 13px;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}