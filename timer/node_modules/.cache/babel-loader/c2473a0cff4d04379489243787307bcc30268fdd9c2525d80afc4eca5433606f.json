{"ast":null,"code":"import { reactive, computed } from 'vue';\nimport authAPI from '../api/auth.js';\n\n// Áî®Êà∑ËÆ§ËØÅÁä∂ÊÄÅÁÆ°ÁêÜ\nconst authState = reactive({\n  user: JSON.parse(localStorage.getItem('user')) || null,\n  token: localStorage.getItem('token') || null,\n  isLoading: false\n});\nexport const useAuthStore = () => {\n  // ËÆ°ÁÆóÂ±ûÊÄß\n  const isAuthenticated = computed(() => !!authState.token && !!authState.user);\n  const currentUser = computed(() => authState.user);\n  const isLoading = computed(() => authState.isLoading);\n\n  // ‰øùÂ≠òËÆ§ËØÅ‰ø°ÊÅØÂà∞Êú¨Âú∞Â≠òÂÇ®\n  const saveAuthData = (user, token) => {\n    console.log('üíæ ‰øùÂ≠òÁî®Êà∑ËÆ§ËØÅ‰ø°ÊÅØÂà∞Êú¨Âú∞Â≠òÂÇ®');\n    authState.user = user;\n    authState.token = token;\n    localStorage.setItem('user', JSON.stringify(user));\n    localStorage.setItem('token', token);\n  };\n\n  // Ê∏ÖÈô§ËÆ§ËØÅ‰ø°ÊÅØ\n  const clearAuthData = () => {\n    console.log('üóëÔ∏è Ê∏ÖÈô§Áî®Êà∑ËÆ§ËØÅ‰ø°ÊÅØ');\n    authState.user = null;\n    authState.token = null;\n    localStorage.removeItem('user');\n    localStorage.removeItem('token');\n  };\n\n  // Áî®Êà∑Ê≥®ÂÜå\n  const register = async userData => {\n    console.log('üìù ÂºÄÂßãÁî®Êà∑Ê≥®ÂÜåÊµÅÁ®ã');\n    authState.isLoading = true;\n    try {\n      const response = await authAPI.register(userData);\n      if (response.success) {\n        const {\n          user,\n          token\n        } = response.data;\n        saveAuthData(user, token);\n        console.log('üéâ Ê≥®ÂÜåÂπ∂Ëá™Âä®ÁôªÂΩïÊàêÂäü!');\n        return {\n          success: true,\n          user\n        };\n      }\n      throw new Error(response.message || 'Ê≥®ÂÜåÂ§±Ë¥•');\n    } catch (error) {\n      console.error('‚ùå Ê≥®ÂÜåÂ§±Ë¥•:', error);\n      throw error;\n    } finally {\n      authState.isLoading = false;\n    }\n  };\n\n  // Áî®Êà∑ÁôªÂΩï\n  const login = async credentials => {\n    console.log('üîê ÂºÄÂßãÁî®Êà∑ÁôªÂΩïÊµÅÁ®ã');\n    authState.isLoading = true;\n    try {\n      const response = await authAPI.login(credentials);\n      if (response.success) {\n        const {\n          user,\n          token\n        } = response.data;\n        saveAuthData(user, token);\n        console.log('üéâ ÁôªÂΩïÊàêÂäü!');\n        return {\n          success: true,\n          user\n        };\n      }\n      throw new Error(response.message || 'ÁôªÂΩïÂ§±Ë¥•');\n    } catch (error) {\n      console.error('‚ùå ÁôªÂΩïÂ§±Ë¥•:', error);\n      throw error;\n    } finally {\n      authState.isLoading = false;\n    }\n  };\n\n  // Áî®Êà∑ÁôªÂá∫\n  const logout = () => {\n    console.log('üëã Áî®Êà∑ÁôªÂá∫');\n    clearAuthData();\n  };\n\n  // Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØ\n  const fetchUserProfile = async () => {\n    console.log('üë§ Ëé∑ÂèñÁî®Êà∑ËØ¶ÁªÜ‰ø°ÊÅØ');\n    try {\n      const response = await authAPI.getUserProfile();\n      if (response.success) {\n        authState.user = response.data.user;\n        localStorage.setItem('user', JSON.stringify(response.data.user));\n        return response.data.user;\n      }\n    } catch (error) {\n      console.error('‚ùå Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:', error);\n      // Â¶ÇÊûútokenÊó†ÊïàÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®\n      if (error.response?.status === 401) {\n        logout();\n      }\n      throw error;\n    }\n  };\n\n  // Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØ\n  const updateProfile = async updateData => {\n    console.log('‚úèÔ∏è Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØ');\n    try {\n      const response = await authAPI.updateUserProfile(updateData);\n      if (response.success) {\n        authState.user = response.data.user;\n        localStorage.setItem('user', JSON.stringify(response.data.user));\n        console.log('‚úÖ Áî®Êà∑‰ø°ÊÅØÊõ¥Êñ∞ÊàêÂäü');\n        return response.data.user;\n      }\n    } catch (error) {\n      console.error('‚ùå Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:', error);\n      throw error;\n    }\n  };\n  return {\n    // Áä∂ÊÄÅ\n    isAuthenticated,\n    currentUser,\n    isLoading,\n    // ÊñπÊ≥ï\n    register,\n    login,\n    logout,\n    fetchUserProfile,\n    updateProfile\n  };\n};\nexport default useAuthStore;","map":{"version":3,"names":["reactive","computed","authAPI","authState","user","JSON","parse","localStorage","getItem","token","isLoading","useAuthStore","isAuthenticated","currentUser","saveAuthData","console","log","setItem","stringify","clearAuthData","removeItem","register","userData","response","success","data","Error","message","error","login","credentials","logout","fetchUserProfile","getUserProfile","status","updateProfile","updateData","updateUserProfile"],"sources":["C:/Users/wuby/OneDrive/Desktop/backend(1) 3/timer/timer/src/store/auth.js"],"sourcesContent":["import { reactive, computed } from 'vue'\nimport authAPI from '../api/auth.js'\n\n// Áî®Êà∑ËÆ§ËØÅÁä∂ÊÄÅÁÆ°ÁêÜ\nconst authState = reactive({\n  user: JSON.parse(localStorage.getItem('user')) || null,\n  token: localStorage.getItem('token') || null,\n  isLoading: false\n})\n\nexport const useAuthStore = () => {\n  // ËÆ°ÁÆóÂ±ûÊÄß\n  const isAuthenticated = computed(() => !!authState.token && !!authState.user)\n  const currentUser = computed(() => authState.user)\n  const isLoading = computed(() => authState.isLoading)\n\n  // ‰øùÂ≠òËÆ§ËØÅ‰ø°ÊÅØÂà∞Êú¨Âú∞Â≠òÂÇ®\n  const saveAuthData = (user, token) => {\n    console.log('üíæ ‰øùÂ≠òÁî®Êà∑ËÆ§ËØÅ‰ø°ÊÅØÂà∞Êú¨Âú∞Â≠òÂÇ®')\n    authState.user = user\n    authState.token = token\n    localStorage.setItem('user', JSON.stringify(user))\n    localStorage.setItem('token', token)\n  }\n\n  // Ê∏ÖÈô§ËÆ§ËØÅ‰ø°ÊÅØ\n  const clearAuthData = () => {\n    console.log('üóëÔ∏è Ê∏ÖÈô§Áî®Êà∑ËÆ§ËØÅ‰ø°ÊÅØ')\n    authState.user = null\n    authState.token = null\n    localStorage.removeItem('user')\n    localStorage.removeItem('token')\n  }\n\n  // Áî®Êà∑Ê≥®ÂÜå\n  const register = async (userData) => {\n    console.log('üìù ÂºÄÂßãÁî®Êà∑Ê≥®ÂÜåÊµÅÁ®ã')\n    authState.isLoading = true\n    try {\n      const response = await authAPI.register(userData)\n      if (response.success) {\n        const { user, token } = response.data\n        saveAuthData(user, token)\n        console.log('üéâ Ê≥®ÂÜåÂπ∂Ëá™Âä®ÁôªÂΩïÊàêÂäü!')\n        return { success: true, user }\n      }\n      throw new Error(response.message || 'Ê≥®ÂÜåÂ§±Ë¥•')\n    } catch (error) {\n      console.error('‚ùå Ê≥®ÂÜåÂ§±Ë¥•:', error)\n      throw error\n    } finally {\n      authState.isLoading = false\n    }\n  }\n\n  // Áî®Êà∑ÁôªÂΩï\n  const login = async (credentials) => {\n    console.log('üîê ÂºÄÂßãÁî®Êà∑ÁôªÂΩïÊµÅÁ®ã')\n    authState.isLoading = true\n    try {\n      const response = await authAPI.login(credentials)\n      if (response.success) {\n        const { user, token } = response.data\n        saveAuthData(user, token)\n        console.log('üéâ ÁôªÂΩïÊàêÂäü!')\n        return { success: true, user }\n      }\n      throw new Error(response.message || 'ÁôªÂΩïÂ§±Ë¥•')\n    } catch (error) {\n      console.error('‚ùå ÁôªÂΩïÂ§±Ë¥•:', error)\n      throw error\n    } finally {\n      authState.isLoading = false\n    }\n  }\n\n  // Áî®Êà∑ÁôªÂá∫\n  const logout = () => {\n    console.log('üëã Áî®Êà∑ÁôªÂá∫')\n    clearAuthData()\n  }\n\n  // Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØ\n  const fetchUserProfile = async () => {\n    console.log('üë§ Ëé∑ÂèñÁî®Êà∑ËØ¶ÁªÜ‰ø°ÊÅØ')\n    try {\n      const response = await authAPI.getUserProfile()\n      if (response.success) {\n        authState.user = response.data.user\n        localStorage.setItem('user', JSON.stringify(response.data.user))\n        return response.data.user\n      }\n    } catch (error) {\n      console.error('‚ùå Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:', error)\n      // Â¶ÇÊûútokenÊó†ÊïàÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®\n      if (error.response?.status === 401) {\n        logout()\n      }\n      throw error\n    }\n  }\n\n  // Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØ\n  const updateProfile = async (updateData) => {\n    console.log('‚úèÔ∏è Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØ')\n    try {\n      const response = await authAPI.updateUserProfile(updateData)\n      if (response.success) {\n        authState.user = response.data.user\n        localStorage.setItem('user', JSON.stringify(response.data.user))\n        console.log('‚úÖ Áî®Êà∑‰ø°ÊÅØÊõ¥Êñ∞ÊàêÂäü')\n        return response.data.user\n      }\n    } catch (error) {\n      console.error('‚ùå Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:', error)\n      throw error\n    }\n  }\n\n  return {\n    // Áä∂ÊÄÅ\n    isAuthenticated,\n    currentUser,\n    isLoading,\n    \n    // ÊñπÊ≥ï\n    register,\n    login,\n    logout,\n    fetchUserProfile,\n    updateProfile\n  }\n}\n\nexport default useAuthStore"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,QAAQ,QAAQ,KAAK;AACxC,OAAOC,OAAO,MAAM,gBAAgB;;AAEpC;AACA,MAAMC,SAAS,GAAGH,QAAQ,CAAC;EACzBI,IAAI,EAAEC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,IAAI;EACtDC,KAAK,EAAEF,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,IAAI,IAAI;EAC5CE,SAAS,EAAE;AACb,CAAC,CAAC;AAEF,OAAO,MAAMC,YAAY,GAAGA,CAAA,KAAM;EAChC;EACA,MAAMC,eAAe,GAAGX,QAAQ,CAAC,MAAM,CAAC,CAACE,SAAS,CAACM,KAAK,IAAI,CAAC,CAACN,SAAS,CAACC,IAAI,CAAC;EAC7E,MAAMS,WAAW,GAAGZ,QAAQ,CAAC,MAAME,SAAS,CAACC,IAAI,CAAC;EAClD,MAAMM,SAAS,GAAGT,QAAQ,CAAC,MAAME,SAAS,CAACO,SAAS,CAAC;;EAErD;EACA,MAAMI,YAAY,GAAGA,CAACV,IAAI,EAAEK,KAAK,KAAK;IACpCM,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;IAC/Bb,SAAS,CAACC,IAAI,GAAGA,IAAI;IACrBD,SAAS,CAACM,KAAK,GAAGA,KAAK;IACvBF,YAAY,CAACU,OAAO,CAAC,MAAM,EAAEZ,IAAI,CAACa,SAAS,CAACd,IAAI,CAAC,CAAC;IAClDG,YAAY,CAACU,OAAO,CAAC,OAAO,EAAER,KAAK,CAAC;EACtC,CAAC;;EAED;EACA,MAAMU,aAAa,GAAGA,CAAA,KAAM;IAC1BJ,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;IAC3Bb,SAAS,CAACC,IAAI,GAAG,IAAI;IACrBD,SAAS,CAACM,KAAK,GAAG,IAAI;IACtBF,YAAY,CAACa,UAAU,CAAC,MAAM,CAAC;IAC/Bb,YAAY,CAACa,UAAU,CAAC,OAAO,CAAC;EAClC,CAAC;;EAED;EACA,MAAMC,QAAQ,GAAG,MAAOC,QAAQ,IAAK;IACnCP,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;IAC1Bb,SAAS,CAACO,SAAS,GAAG,IAAI;IAC1B,IAAI;MACF,MAAMa,QAAQ,GAAG,MAAMrB,OAAO,CAACmB,QAAQ,CAACC,QAAQ,CAAC;MACjD,IAAIC,QAAQ,CAACC,OAAO,EAAE;QACpB,MAAM;UAAEpB,IAAI;UAAEK;QAAM,CAAC,GAAGc,QAAQ,CAACE,IAAI;QACrCX,YAAY,CAACV,IAAI,EAAEK,KAAK,CAAC;QACzBM,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;QAC5B,OAAO;UAAEQ,OAAO,EAAE,IAAI;UAAEpB;QAAK,CAAC;MAChC;MACA,MAAM,IAAIsB,KAAK,CAACH,QAAQ,CAACI,OAAO,IAAI,MAAM,CAAC;IAC7C,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdb,OAAO,CAACa,KAAK,CAAC,SAAS,EAAEA,KAAK,CAAC;MAC/B,MAAMA,KAAK;IACb,CAAC,SAAS;MACRzB,SAAS,CAACO,SAAS,GAAG,KAAK;IAC7B;EACF,CAAC;;EAED;EACA,MAAMmB,KAAK,GAAG,MAAOC,WAAW,IAAK;IACnCf,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;IAC1Bb,SAAS,CAACO,SAAS,GAAG,IAAI;IAC1B,IAAI;MACF,MAAMa,QAAQ,GAAG,MAAMrB,OAAO,CAAC2B,KAAK,CAACC,WAAW,CAAC;MACjD,IAAIP,QAAQ,CAACC,OAAO,EAAE;QACpB,MAAM;UAAEpB,IAAI;UAAEK;QAAM,CAAC,GAAGc,QAAQ,CAACE,IAAI;QACrCX,YAAY,CAACV,IAAI,EAAEK,KAAK,CAAC;QACzBM,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;QACvB,OAAO;UAAEQ,OAAO,EAAE,IAAI;UAAEpB;QAAK,CAAC;MAChC;MACA,MAAM,IAAIsB,KAAK,CAACH,QAAQ,CAACI,OAAO,IAAI,MAAM,CAAC;IAC7C,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdb,OAAO,CAACa,KAAK,CAAC,SAAS,EAAEA,KAAK,CAAC;MAC/B,MAAMA,KAAK;IACb,CAAC,SAAS;MACRzB,SAAS,CAACO,SAAS,GAAG,KAAK;IAC7B;EACF,CAAC;;EAED;EACA,MAAMqB,MAAM,GAAGA,CAAA,KAAM;IACnBhB,OAAO,CAACC,GAAG,CAAC,SAAS,CAAC;IACtBG,aAAa,CAAC,CAAC;EACjB,CAAC;;EAED;EACA,MAAMa,gBAAgB,GAAG,MAAAA,CAAA,KAAY;IACnCjB,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;IAC1B,IAAI;MACF,MAAMO,QAAQ,GAAG,MAAMrB,OAAO,CAAC+B,cAAc,CAAC,CAAC;MAC/C,IAAIV,QAAQ,CAACC,OAAO,EAAE;QACpBrB,SAAS,CAACC,IAAI,GAAGmB,QAAQ,CAACE,IAAI,CAACrB,IAAI;QACnCG,YAAY,CAACU,OAAO,CAAC,MAAM,EAAEZ,IAAI,CAACa,SAAS,CAACK,QAAQ,CAACE,IAAI,CAACrB,IAAI,CAAC,CAAC;QAChE,OAAOmB,QAAQ,CAACE,IAAI,CAACrB,IAAI;MAC3B;IACF,CAAC,CAAC,OAAOwB,KAAK,EAAE;MACdb,OAAO,CAACa,KAAK,CAAC,aAAa,EAAEA,KAAK,CAAC;MACnC;MACA,IAAIA,KAAK,CAACL,QAAQ,EAAEW,MAAM,KAAK,GAAG,EAAE;QAClCH,MAAM,CAAC,CAAC;MACV;MACA,MAAMH,KAAK;IACb;EACF,CAAC;;EAED;EACA,MAAMO,aAAa,GAAG,MAAOC,UAAU,IAAK;IAC1CrB,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;IACxB,IAAI;MACF,MAAMO,QAAQ,GAAG,MAAMrB,OAAO,CAACmC,iBAAiB,CAACD,UAAU,CAAC;MAC5D,IAAIb,QAAQ,CAACC,OAAO,EAAE;QACpBrB,SAAS,CAACC,IAAI,GAAGmB,QAAQ,CAACE,IAAI,CAACrB,IAAI;QACnCG,YAAY,CAACU,OAAO,CAAC,MAAM,EAAEZ,IAAI,CAACa,SAAS,CAACK,QAAQ,CAACE,IAAI,CAACrB,IAAI,CAAC,CAAC;QAChEW,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC;QACzB,OAAOO,QAAQ,CAACE,IAAI,CAACrB,IAAI;MAC3B;IACF,CAAC,CAAC,OAAOwB,KAAK,EAAE;MACdb,OAAO,CAACa,KAAK,CAAC,aAAa,EAAEA,KAAK,CAAC;MACnC,MAAMA,KAAK;IACb;EACF,CAAC;EAED,OAAO;IACL;IACAhB,eAAe;IACfC,WAAW;IACXH,SAAS;IAET;IACAW,QAAQ;IACRQ,KAAK;IACLE,MAAM;IACNC,gBAAgB;IAChBG;EACF,CAAC;AACH,CAAC;AAED,eAAexB,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}